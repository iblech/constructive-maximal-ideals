\documentclass[com,11pt,crcready]{iosart2x}
\pdfoutput=1

\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{amssymb,amsmath,mathtools,proof,amsthm,stmaryrd}
\usepackage[dvipsnames]{xcolor}
\usepackage[protrusion=true,expansion=true]{microtype}
\usepackage{fontawesome5}

\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\newtheorem{construction}[definition]{Construction}
\newtheorem{example}[definition]{Example}

\theoremstyle{plain}
\newtheorem{proposition}[definition]{Proposition}
\newtheorem{corollary}[definition]{Corollary}
\newtheorem{lemma}[definition]{Lemma}
\newtheorem{theorem}[definition]{Theorem}
\newtheorem{scholium}[definition]{Scholium}

\theoremstyle{remark}
\newtheorem{remark}[definition]{Remark}
\newtheorem{question}[definition]{Question}
\newtheorem{speculation}[definition]{Speculation}
\newtheorem{caveat}[definition]{Caveat}
\newtheorem{conjecture}[definition]{Conjecture}

\newcommand{\Incbare}{\mathsf{Inc}}
\newcommand{\Inc}[1]{\operatorname{\Incbare}\,#1}
\newcommand{\?}{\,{:}\,}
\newcommand{\seq}[1]{\mathrel{\vdash\!\!\!_{#1}}}
\newcommand{\aaa}{\mathfrak{a}}
\newcommand{\mmm}{\mathfrak{m}}
\newcommand{\nnn}{\mathfrak{n}}
\newcommand{\ppp}{\mathfrak{p}}
\newcommand{\qqq}{\mathfrak{q}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\TT}{\mathbb{T}}
\newcommand{\defeq}{\vcentcolon=}
\newcommand{\Cov}{\mathrm{Cov}}
\newcommand{\forces}{\vDash}
\renewcommand{\_}{\mathpunct{.}\,}

% lifted from https://arxiv.org/abs/2301.10696
\newcommand{\formalized}{{\color{NavyBlue!75!White}{\raisebox{-0.5pt}{\scalebox{0.8}{\faCog}}}}}
\newcommand{\flinkurl}[1]{\href{#1}{\formalized}}
\newcommand{\flink}[1]{\flinkurl{https://iblech.github.io/constructive-maximal-ideals/index.html\##1}}

\pubyear{0000}
\volume{0}
\firstpage{1}
\lastpage{1}

\begin{document}

\begin{frontmatter}

\title{Reifying dynamical algebra: \\ maximal ideals in countable rings, constructively}
\runtitle{Reifying dynamical algebra: maximal ideals in countable rings, constructively}

\begin{aug}
\author[A]{\inits{I.}\fnms{Ingo}
\snm{Blechschmidt}\ead[label=e1]{iblech@speicherleck.de}}
\author[B]{\inits{P.}\fnms{Peter}
\snm{Schuster}\ead[label=e2]{petermichael.schuster@univr.it}}
\address[A]{Institut für Mathematik, \orgname{Universität Augsburg},
\cny{Germany}\printead[presep={\\}]{e1}}
\address[B]{Dipartimento di Informatico, \orgname{Università di Verona},
\cny{Italy}\printead[presep={\\}]{e2}}
\end{aug}

\begin{abstract}
  The existence of a maximal ideal in a general nontrivial commutative
  ring is tied together with the axiom of choice.
  Following Berardi, Valentini and thus Krivine but using the relative interpretation of
  negation (that is, as ``implies~$0=1$'') we show, in constructive set theory with
  minimal logic, how for countable rings one can do without any kind of choice
  and without the usual decidability assumption that the ring is strongly
  discrete (membership in finitely generated ideals is decidable).
  By a functional
  recursive definition we obtain a maximal ideal in the sense that the quotient ring is a residue field
  (every noninvertible element is zero), and with strong discreteness
  even a geometric field (every element is either invertible or
  else zero). Krull's lemma for the related notion of prime ideal follows by
  passing to rings of fractions.
  By employing a construction variant of set-theoretic forcing due to Joyal and
  Tierney, we expand our treatment to arbitrary rings and establish a
  connection with dynamical algebra: We
  recover the dynamical approach to maximal ideals as a parametrized version of the
  celebrated double-negation translation. This connection allows us to give formal a priori criteria
  elucidating the scope of the dynamical method.
  Along the way we do a case study for proofs in algebra with minimal logic,
  and generalize the construction to arbitrary inconsistency predicates. A partial Agda
  formalization is available at an accompanying repository.\footnote{See
  \href{https://github.com/iblech/constructive-maximal-ideals/}{\texttt{https:/$\!$/github.com/iblech/constructive-maximal-ideals/}.}
  This text is a revised and extended version
  of the conference paper~\cite{blechschmidt-schuster:constructive-maximal-ideals}. The conference paper only
  briefly sketched the connection with dynamical algebra; did not compare this
  connection with other flavors of set-theoretic forcing; and sticked to the case
  of commutative algebra only, passing on the generalization to inconsistency predicates
  and well-orders.}
\end{abstract}

\begin{keyword}
\kwd{maximal ideals}
\kwd{set-theoretic forcing}
\kwd{constructive commutative algebra}
\kwd{dynamical algebra}
\end{keyword}

\end{frontmatter}

\noindent
Let~$A$ be a commutative ring with unit. The standard way of constructing a
maximal ideal of~$A$ is to apply Zorn's lemma to the set of proper ideals
of~$A$; but this method is less an actual construction and more an appeal to
the transfinite.

If~$A$ is countable with enumeration~$x_0,x_1,\ldots$, we can hope to provide a
more explicit construction by successively adding generators to the zero ideal,
skipping those which would render it improper:
\begin{equation}\label{eq:orig-construction}
  \tag{$\star$}\begin{aligned}
  \mmm_0 &= \{ 0 \}, \\
  \mmm_{n+1} &= \begin{cases}
    \mmm_n + (x_n), & \text{if $1 \not\in \mmm_n + (x_n)$}, \\
    \mmm_n, & \text{else.}
  \end{cases}
\end{aligned}\end{equation}
A maximal ideal is then obtained in the limit as the union of the intermediate
stages~$\mmm_n$. For instance, Krull in his 1929 \emph{Annalen} contribution~\cite[Hilfs\-satz]{krull:ohne} and books on constructive
algebra~\cite[Lemma~VI.3.2]{mines-richman-ruitenburg:constructive-algebra},~\cite[comment after Theorem~VII.5.2]{lombardi-quitte:constructive-algebra} proceed in this fashion.
A similar
construction concocts Henkin models for the purpose of proving
Gödel's completeness theorem for countable languages, successively adding
formulas which do not render the current set
inconsistent~\cite[Satz~I.56]{tarski:fundamental},~\cite[Lemma~1.5.7]{dalen:logic},~\cite[Lemma~III.5.4]{simpson:subsystems},~\cite[Lemma~2.1]{ishihara-khoussainov-nerode:decidable-kripke-models},~\cite[Section~A.4]{coquand-lombardi:hidden-krull}.

This procedure avoids all forms of choice by virtue of being a
functional recursive definition, but still requires some form of omniscience in
order to carry out the case distinction.
In Section~\ref{sect:constr} we study a variant of this construction, due to Berardi and
Valentini~\cite{berardi-valentini:krivine}, which
avoids non-constructive principles and decidability assumptions, similar to
a construction which has been studied by
Krivine~\cite[p.~410]{krivine:completeness} and later Herbelin and
Ilik~\cite[p.~11]{herbelin-ilik:henkin} in the
context of Gödel's completeness theorem.

In this generality, the resulting
maximal ideal has an elusive quality to it, but useful properties and positive information can still be
extracted. We recover the original construction under certain
decidability assumptions (Proposition~\ref{prop:with-test}). To further
elucidate the essential aspects of the construction, Section~\ref{sect:inc-wf}
contains a streamlined account in the setting of \emph{abstract inconsistency
predicates}.


\subsection*{Extraction of computational content} We illustrate the scope of
applications of the maximal ideal construction of Section~\ref{sect:constr} by
exploring, in Section~\ref{sect:krull}, several established test cases for
Hilbert's program in commutative algebra. Among them is the following
(Proposition~\ref{prop:surj-matrix}):
\begin{quote}\small
\textbf{Proposition.} Let~$A$ be a ring. Let~$M \in A^{n \times m}$ be a matrix with more rows
than columns. Assume that the induced linear map~$A^m \to A^n$ is surjective.
Then~$1 = 0$ in~$A$.
\smallskip

\textbf{Proof.} Assume for the sake of a contradiction that~$1 \neq 0$ in~$A$.
Then, by the axiom of choice, there exists a maximal ideal~$\mmm$. The quotient
ring~$k \defeq A/\mmm$ is a field and the induced linear map~$k^m \to k^n$ is
still surjective. Hence we have a contradiction to basic linear algebra over fields.
\end{quote}
This proof is short, elegant, a prototypical examplar of a common reduction
technique in commutative algebra---and wholly unconstructive. Is there also a
direct computational argument?

Since the statement of the proposition is, for fixed matrix dimensions, a
coherent sequent (in the language of rings), the completeness
theorem for coherent logic~\cite[Corollary~D1.5.10]{johnstone:elephant} implies a priori that there exists a proof in
coherent logic, hence in particular a constructive proof. The completeness
theorem, however, rests on the Boolean prime ideal theorem, a version of the
axiom of choice~\cite[Remark~D1.5.11]{johnstone:elephant},~\cite{scott:prime,henkin:metamath,banaschewski:ultrafilter}. Do we actually know a direct computational argument?

Yes (for brevity, case~$n = 2$, $m = 1$ only---see~\cite{richman:trivial-rings} for a general proof): Write~$M =
\left(\begin{smallmatrix}x\\y\end{smallmatrix}\right)$. By surjectivity,
there are ring elements~$u, v$ with
$
  u \left(\begin{smallmatrix}x\\y\end{smallmatrix}\right) = \left(\begin{smallmatrix}1\\0\end{smallmatrix}\right)
$
and
$
  v \left(\begin{smallmatrix}x\\y\end{smallmatrix}\right) = \left(\begin{smallmatrix}0\\1\end{smallmatrix}\right)
$.
Hence $1 = (vy) (ux) = (uy) (vx) = 0$.

The challenge in mathematical logic is to extract a direct computational
argument from the given classical proof, and for this particular example
there are several techniques which meet this challenge. Section~\ref{sect:krull} shows that
also the explicit maximal ideal construction of Section~\ref{sect:constr} can be used to this end---assuming
that the ring is countable.


\subsection*{Extension to the uncountable case}

What if the ring~$A$ is not countable, or if it is countable but
an enumeration~$\NN \twoheadrightarrow A$ is expensive to
evaluate?

In absence of the axiom of choice, some restriction on the
rings is required, as it is well-known that the statement that any nontrivial
ring has a maximal ideal implies (over Zermelo--Fraenkel set
theory~\textsc{zf}) the axiom of choice~\cite{scott:prime-ideals,hodges:krull,banaschewski:krull,erne:krull,howard-rubin:ac}.
However, this limitation only pertains to the abstract existence of maximal
ideals, not to concrete consequences of their existence. Mathematical
logic teaches us by way of diverse examples to not conflate these two concerns.

For
instance, although~\textsc{zf} does not prove the axiom of choice, it does
prove every theorem of~\textsc{zfc} pertaining only to natural numbers (by
interpreting a given~\textsc{zfc}-proof in the constructible universe~$L$
and exploiting that the natural numbers are absolute between~$V$
and~$L$~\cite{goedel:ac-gch,schoenfield:predicativity}); similarly, although intuitionistic Zermelo--Fraenkel set
theory~\textsc{izf} does not prove the law of excluded middle, it does prove
every~$\Pi^0_2$-theorem of~\textsc{zf} (by the double negation translation
combined with Friedman's continuation trick~\cite{friedman:double-negation-translation}).

A similar phenomenon concerns countability.
Set theory teaches us that
whether a given set is countable depends not only on the set itself, but is
more aptly regarded as a property of the ambient universe~\cite{hamkins:multiverse}: Given any
set~$M$, there is a forcing extension~\cite{moore:forcing,weaver:forcing,geschke:models,geschke-quickert:forcing} of the universe in which~$M$ becomes
countable.\footnote{An analogous situation in commutative algebra is the
following. Whether a ring element~$x$ is invertible not only depends
on the element itself, but is more aptly regarded as a property of the ring~$A$
it is an element of. Any element~$x$ can become invertible by passing from the
base ring~$A$ to the localization~$A[x^{-1}]$.}
The process of traveling to this extension is called \emph{Lévy
collapse}~\cite[Section~I.6]{jech:forcing},~\cite[Chapter~5]{bell:set-theory}. Set
theorists have used this technique and other forcing models with great success,
mostly in order to explore the range of set-theoretic possibility. However, they can
also be used as tools to deduce results about the base universe.

More precisely, to apply the iterative step-by-step construction of a maximal ideal to a
ring~$A$ which might not be countable in a constructive setting, we employ a
constructive variant of Lévy collapse due to Joyal and
Tierney~\cite[pp.~36f.]{joyal-tierney:grothendieck}: Given a ring~$A$, there
is an extension of the universe---a certain sheaf topos with a concrete
computational interpretation---in which the ring~$A$ appears countable; this extended
universe contains what is called the \emph{generic surjection} from~$\NN$
to~$A$. We can then apply the iterative construction in this extended universe
to obtain a maximal ideal of~$A$ there; from the point of view of the base
universe, we will not actually have constructed an ideal of~$A$ but rather a
``sheaf of ideals of the constant sheaf associated to~$A$''.

Crucially, the passage to such an extension preserves and reflects
bounded first-order statements, those first-order statements where all
quantifiers range over sets of the base universe.\footnote{This property is well-known for classical
set-theoretic forcing, for the plain reason that the base model~$V$ is a
transitive subset of the forcing extension~$V[G]$. Constructively, it is a property enjoyed only by some
particular forcing notions. In topos-theoretic language, the canonical
geometric morphism from any Grothendieck topos to the base topos is open
if the base satisfies the law of excluded middle~\cite[p.~57]{joyal-tierney:grothendieck}, so every Grothendieck topos is
overt. In contrast, overtness is a nontrivial property if the law of excluded
middle is not available. We are grateful to Robert Lubarsky for pointing out
this difference to classical forcing to us.}
Hence we have the following metatheorem:
\begin{quote}\emph{Countability
assumptions from intuitionistic proofs of bounded first-order statements can always be
mechanically eliminated.}\end{quote}
To wit: If our aim is to verify some bounded first-order
statement~$P$ about a perhaps uncountable ring~$A$, such as the statement about
surjective matrices above, we may just as well assume that~$A$ is countable,
because it actually will be so in the extended universe and because every
bounded first-order property which holds there will also hold for~$A$ in the base
universe.

Crucially, the first-order restriction is only on the form
of the statements, not on the form of the proofs. These may freely employ higher-order constructs.
``First-order'' statements are statements which only refer to elements, not to
subsets. The statement ``there is a maximal ideal'' is a higher-order
statement, hence we cannot eliminate countability assumptions from proofs of
this statement; but we can eliminate countability assumptions from proofs of
first-order consequences of the existence of a maximal ideal.

We present details of this technique in Section~\ref{sect:wlog}. Unlike
Joyal and Tierney, who pursued a semantic approach employing the language of
toposes, our presentation leans on the syntactical side and is explicitly computational in
nature. Owing to the central role played by a certain generalized inductive definition, we connect forcing
with established notions in theoretical computer science.
No familiarity with categories, sheaves or toposes is required.

In classical set theory, the feature that forcing preserves and reflects
bounded first-order formulas is sometimes regarded as a deficiency of the
forcing technique, limiting us in the range of models of set theory we can
construct. We turn this view upside down: This feature is the central property
enabling the applications we desire. We hence bolster Judith Roitman's thesis
that ``mainstream mathematics [\ldots\!] is beginning to see results using modern
set theoretic techniques''~\cite{roitman:uses} by providing an instance in
constructive algebra, and hope to make forcing more accessible.

Summarizing, our approach strengthens the view of maximal ideals as convenient
fictions~\cite[Section~1]{schuster-wessel:krull}, in line with a famous motto
of Poincaré~\cite{poincare:logique}:
\begin{quote}
\emph{Never lose sight of the fact that every proposition concerning infinity
must be the translation, the precise statement of propositions concerning the
finite.}
\end{quote}

Maximal ideals can carry out
their work by any of the following possibilities:
\begin{enumerate}
\item[(1)] For countable (or well-founded) rings, no help is required.
Section~\ref{sect:constr} presents an explicit construction of a maximal ideal.
\item[(2)] For arbitrary rings, the existence of a maximal ideal follows from the
axiom of choice.
\item[(3)] Intuitionistic first-order consequences of the existence of a maximal
ideal are true even if no actual maximal ideal can be constructed.
\end{enumerate}


\subsection*{Connection with dynamical algebra}

In Section~\ref{sect:dynalg} we turn to the general toolbox of dynamical
algebra~\cite{coquand-lombardi-roy:dynamicalmethod},~\cite[Section~XV.6]{lombardi-quitte:constructive-algebra},~\cite{yengui:constructive},~\cite{duval:about},~\cite{neuwirth:lorenzen}. Since its
independent inventions by Dominique Duval and Paul
Lorenzen, this toolbox has been widely
successful in extracting computational content from classical proofs
appealing to the transfinite, including proofs of prominent theorems such as
Suslin's lemma~\cite{suslin:structure,yengui:maximal} or a theorem by
Becher~\cite{becher:csa}, a consequence of a theorem by Merkurjev.

The specific use case we are interested in concerns the wide class of classical
commutative algebra proofs pursuing the following general outline:
% NOTE FOR TYPESETTING: It is on purpose that we are not using the proof
% environment here, as we are quoting these classical proofs as objects of
% demonstration. We are not actually using these proofs in our development, we
% are just referencing them.
\begin{quote}\small Assume for the sake of contradiction that~$1 \neq 0$. Then, by the
axiom of choice, there exists a maximal ideal~$\mmm$. By (\ldots computation
and arguments\ldots\!), we obtain that~$1 \in \mmm$. This is a contradiction.
Hence~$1 = 0$.\end{quote}

The aim is to extract from such a classical proof a direct computational argument that~$1 = 0$.
To this end, the toolbox of dynamical algebra suggests a
\emph{dynamical rereading} of the given proof. Instead of appealing to the
transfinite in order to concoct a completed maximal ideal~$\mmm$, we make do
with finitely generated approximations to a maximal ideal, starting out with
the zero ideal~$\aaa = (0)$ and repeatedly refining this approximation over the
course of the proof.

\label{page:dynalg-folding}
Classically, the fundamental property of a maximal ideal~$\mmm$ is that for every ring
element~$x$, either~$x \in \mmm$ or~$1 \in \mmm + (x)$. When the given classical
proof appeals to this property, we tentatively refine the current
approximation from~$\aaa$ to~$\aaa + (x)$, pretending that the first alternative
holds, and resume the proof. When the proof reaches the conclusion~$1 \in
\mmm$, we have learnt the positive information that~$1 \in \aaa + (x)$.
Equipped with this information, we reset the current approximation back to~$\aaa$
and again follow the classical proof, now pretending that the second
alternative holds. When the proof reaches the conclusion~$1 \in \mmm$ a second
time, we have learnt that~$1 \in \aaa$. In this way we fold up branches of the
proof until, in the end, we obtain~$1 \in (0)$, so~$1 = 0$.

In good circumstances, this approach allows us to constructivize the given
classical proof. However, from the point of view of a metamathematical
analysis, several questions remain: What are the precise conditions on the
given classical proof for this method to succeed? Which restriction on its
means is required?
Can we extend this method in
case the desired conclusion is of a more general form than the simple
identity~$1 = 0$?

We answer these questions in Section~\ref{sect:dynalg} by connecting the
dynamical method with the iterative construction of an actual maximal ideal of
Section~\ref{sect:constr}. More precisely:
\begin{quote}\it The dynamical approach to maximal ideals is equivalent to
\begin{enumerate}
\item[(1)] the iterative construction of a maximal ideal,
\item[(2)] applied to the generic enumeration.
%\item[(2)] the double-negation translation followed by Friedman's continuation
%trick as in Barr's theorem.
\end{enumerate}
\end{quote}
In this way we reify the dynamical approach to maximal ideals.


\paragraph{Acknowledgments}
The present study was carried out within the project ``Reducing complexity in
algebra, logic, combinatorics -- REDCOM'' belonging to the program ``Ricerca
Scientifica di Eccellenza 2018'' of the Fondazione Cariverona and GNSAGA of the INdAM.%
\footnote{The opinions expressed in this paper are solely those of the
authors.} Important steps towards this paper were made
during the Dagstuhl Seminar 21472 ``Geometric Logic, Constructivisation, and
Automated Theorem Proving'' in November 2021. This paper would not have come to
existence without the authors' numerous discussions with Daniel Misseleck-Wessel, and
greatly benefited from astute comments of Adrian Antz, Karim Becher, Nicolas Daans, Kathrin Gimmi, Matthias Hutzler,
Tadeusz Litak, Christian Sattler,
Noah Schweber, Lukas Stoll, the three anonymous reviewers of the abridged
precursor text to this
article~\cite{blechschmidt-schuster:constructive-maximal-ideals} and the two
reviewers of the present text.

\paragraph{Conventions} Throughout this note, we fix a ring~$A$, and work in a constructive metatheory.
In the spirit of Lombardi and Quitté~\cite{lombardi-quitte:constructive-algebra}, we employ \emph{minimal
logic}~\cite{johansson:minimal}, where by ``not~$\varphi$'' we mean~``$\varphi \Rightarrow 1 =_A 0$'', and do \emph{not} assume any form of the axiom of choice. Consequently,
by~``$x \not\in M$'' we mean~$x \in M \Rightarrow 1 =_A 0$, and a subset~$M
\subseteq A$ is \emph{detachable} if and only if for all~$x \in A$, either~$x \in M$
or~$x \not\in M$. For general background on constructive mathematics, we refer
to~\cite{bauer:five-stages,bauer:int-mathematics,sep:constructive-mathematics}.

For an arbitrary subset~$M \subseteq A$, not necessarily
detachable, the ideal~$(M)$ generated by~$M$ is given by~$\bigl\{ \sum_{i=1}^n
a_i v_i \,\big|\, n \geq 0, a_1,\ldots,a_n \in A, v_1,\ldots,v_n \in M \bigr\}$.
Notice that, for every element~$v \in (M)$, it holds that $v = 0$ or that $M$ is inhabited, depending on whether
$n=0$ or $n>0$ in $\sum_{i=1}^n a_i v_i$. This can also be seen from the alternative inductive
generation of $(M)$ by the following rules:\par
{\vspace*{-0.8em}\small\[
\infer{v \in (M)}{v=0}
\qquad\qquad
\infer{v \in (M)}{v \in M}
\qquad\qquad
\infer{v+w \in (M)}{v \in (M)\quad w \in (M)}
\qquad\qquad
\infer{av \in (M)}{\quad a\in A \quad v \in (M)}
\]}%
\noindent Here we adhere to the paradigm of generalized inductive definitions
\cite{aczel-rathjen:notes,aczel-rathjen:cstdraft,rathjen:genind,aczel:ind}.

Throughout the online version of this paper, the symbol~``\formalized{}'' is a
clickable link to the corresponding machine-checked statement.


\section{An iterative construction of maximal ideals}
\label{sect:constr}

We assume that the ring~$A$ is countable, with~$x_0, x_1, \ldots$ an
enumeration of the elements of~$A$. We do \emph{not} assume that~$A$ is
discrete (that is, that~$x = y$ or~$x \neq y$ for all elements of~$A$) or that
it is strongly discrete (that is, that finitely generated
ideals of~$A$ are detachable). Up to Corollary~\ref{cor:is-prime-max}(a) below
we follow~\cite{berardi-valentini:krivine}.

We study the following recursive construction of ideals~$\mmm_0, \mmm_1,
\ldots$ of~$A$~(\flink{§1.Construction-1}):
\begin{align*}
  \mmm_0 &\defeq \{0\}, \\
  \mmm_{n+1} &\defeq \mmm_n + (\{ x_n \,|\, 1 \not\in \mmm_n + (x_n) \}).
\end{align*}
Finally, we set~$\mmm \defeq \bigcup_n \mmm_n$. The construction
of~$\mmm_{n+1}$ from~$\mmm_n$ is uniquely specified, requiring no choices of
any form.

The set~$M_n \defeq \{ x_n \,|\, 1 \not\in \mmm_n + (x_n) \}$ occurring in this
construction contains the element~$x_n$ if and only if~$1 \not\in \mmm_n +
(x_n)$; it is obtained from the singleton set~$\{x_n\}$ by bounded separation.
This set~$M_n$ is inhabited precisely if~$1 \not\in \mmm_n + (x_n)$, in which case~$\mmm_{n+1} = \mmm_n + (x_n)$.
However, in the generality we work in, we cannot assume that~$M_n$ is empty or
inhabited.

We can avoid the case distinction by the flexibility of nondetachable
subsets, rendering it somewhat curious that---despite the conveyed flavor of a
conjuring trick---the construction can still be used to obtain concrete
positive results.

The ideal~$(M_n)$ is given by
$(M_n) = \{ a x_n \,|\, (a = 0) \vee (1 \not\in \mmm_n + (x_n)) \}$.

\begin{lemma}[\flink{§1.Lemma-1-1}]\label{lemma:omnibus}
\begin{enumerate}
\item[\textnormal{(a)}] The subset~$\mmm$ is an ideal.
\item[\textnormal{(b)}] The ideal~$\mmm$ is \emph{proper} in the sense that~$1 \not\in \mmm$.
\item[\textnormal{(c)}] For every number~$n \in \NN$, the following are equivalent: \\
(1)~$x_n \in \mmm_{n+1}$.\quad
(2)~$x_n \in \mmm$.\quad
(3)~$1 \not\in \mmm + (x_n)$.\quad
(4)~$1 \not\in \mmm_n + (x_n)$.
\end{enumerate}
\end{lemma}

\begin{proof}\begin{enumerate}
\item[(a)] Directed unions of ideals are ideals.
\item[(b)] Assume~$1 \in \mmm$. Then~$1 \in \mmm_n$ for some number~$n \geq 0$. We
verify~$1 = 0$ by induction over~$n$.
If~$n = 0$, then~$1 \in \mmm_0 = \{0\}$. Hence~$1 = 0$.

If~$n > 0$, then~$1 = y + a x_{n-1}$ for some elements~$a,y \in A$ such that~$y
\in \mmm_{n-1}$ and such that~$a = 0$ or~$1 \not\in \mmm_{n-1} + (x_{n-1})$.
In the first case, we have~$1 = y \in \mmm_{n-1}$, hence~$1 = 0$ by the induction
hypothesis. In the second case we have~$1 = 0$ by modus ponens applied to the
implication~$1 \not\in \mmm_{n-1} + (x_{n-1})$ and the fact~$1 \in \mmm_{n-1} +
(x_{n-1})$ (which follows directly from the equation~$1 = y + a x_{n-1}$).
\item[(c)] It is clear that~$(3) \Rightarrow (4) \Rightarrow (1) \Rightarrow
(2)$. It remains to show that~$(2) \Rightarrow (3)$.

Assume~$x_n \in \mmm$. In order to verify~$1 \not\in \mmm + (x_n)$,
assume~$1 \in \mmm + (x_n)$. Since~$\mmm + (x_n) \subseteq \mmm$,
we have~$1 \in \mmm$. Hence~$1 = 0$ by properness of~$\mmm$.\qedhere
\end{enumerate}\end{proof}

\begin{corollary}[\flink{§1.Corollary-1-2}]\label{cor:is-prime-max}
\begin{enumerate}
\item[\textnormal{(a)}] The ideal~$\mmm$ is \emph{maximal} in the sense that it is proper and that for
all elements $x \in A$, if $1 \not\in \mmm + (x)$, then~$x \in \mmm$.
\item[\textnormal{(b)}] The ideal~$\mmm$ is \emph{prime} in the
sense that it is proper and that for
all elements~$x,y \in A$, if~$xy \in \mmm$ and~$x \not\in \mmm$, then~$y \in
\mmm$.
\item[\textnormal{(c)}] The ideal~$\mmm$ is \emph{radical} in the sense that for every~$k \geq 0$, if~$x^k \in
\mmm$, then~$x \in \mmm$.
\end{enumerate}
\end{corollary}

\begin{proof}\begin{enumerate}
\item[(a)] Immediate by Lemma~\ref{lemma:omnibus}(c).
\item[(b)] This claim is true even for arbitrary maximal ideals: By maximality, it suffices to verify that~$1 \not\in
\mmm + (y)$. If~$1 \in \mmm + (y)$, then~$x = x\cdot1 \in (x) \cdot \mmm + (xy)
\subseteq \mmm$ by~$xy \in \mmm$, hence~$x \in \mmm$, thus~$1 = 0$ by~$x \not\in
\mmm$.
\item[(c)] Let~$x^k \in \mmm$. Then~$1 \not\in \mmm + (x)$, for if~$1 \in
\mmm + (x)$, then also~$1 = 1^k \in (\mmm + (x))^k \subseteq \mmm + (x^k)
\subseteq \mmm$. Hence~$x \in \mmm$ by maximality.\qedhere
\end{enumerate}
\end{proof}

\begin{remark}The ideal~$\mmm$ is double negation stable: for every
ring element~$x$, if~$\neg\neg(x \in \mmm)$, then~$x \in \mmm$. This is because
by Lemma~\ref{lemma:omnibus}(c) membership of~$\mmm$ is a negative condition
and~$\neg\neg\neg\varphi \Rightarrow \neg\varphi$ is a tautology of minimal
logic.\end{remark}

This first-order maximality condition of Corollary~\ref{cor:is-prime-max}(a) is
equivalent~\cite{berardi-valentini:krivine} to the following higher-order version: For every ideal~$\nnn$ such that~$1
\not\in \nnn$, if~$\mmm \subseteq \nnn$, then~$\mmm = \nnn$.

The quotient ring~$A/\mmm$ is a \emph{residue field} in that~$1 \neq 0$
and that every element which is not invertible is zero---as with the real or
complex numbers in constructive mathematics.\footnote{Residue fields have
many of the basic properties of the fields from classical mathematics. For
instance, minimal generating families of vector spaces over residue fields are
linearly independent, finitely generated vector spaces do (up to~$\neg\neg$) have
a finite basis, monic polynomials possess splitting fields and Noether
normalization is available (the proofs
in~\cite{mines-richman-ruitenburg:constructive-algebra} can be suitably
adapted). The constructively rarer \emph{geometric fields}---those kinds of
fields for which every element is either invertible or zero---are required to
ensure, for instance, that kernels of matrices are finite dimensional and that bilinear forms
are diagonalizable.}
Each of the latter is in fact a \emph{Heyting field},
a residue field which also is a \emph{local ring}: if a finite
sum is invertible then one of the summands is.

\begin{example}If we enumerate~$\ZZ$ by~$0,1,-1,2,-2,\ldots$, the
ideal~$\mmm$ coincides with the ideal~$(2)$. If the enumeration starts with a
prime~$p$, the ideal~$\mmm$ coincides with~$(p)$. More generally, if~$A$
is a countable Bézout ring and the enumeration starts with an irreducible
element~$p$, then~$\mmm$ coincides with~$(p)$.
% Trivially, we have (p) ⊆ m.
% Let x ∈ m. Write (x,p) = (d). Then d ∈ m.
% As d | p, we have d ~ 1 or d ~ p. In the first case 1 ∈ m, hence 1 = 0.
% In the second case, x ∈ (p).
\end{example}

\begin{example}Let~$A = \ZZ/\aaa$, where~$\aaa = (\{6\} \cup \{2\,|\,P\} \cup
\{3\,|\,Q\})$ and~$P$ and~$Q$ are incompatible propositions, be enumerated
by~$0,1,5,2,3,4$. Then~$\mmm = \{0\} \cup \{2\,|\,\neg Q\} \cup \{4\,|\,\neg Q\}
\cup \{3\,|\,\neg\neg Q\wedge\neg P\}$. It is instructive to check, with this
description, that the maximality condition of
Corollary~\ref{cor:is-prime-max}(a) is satisfied. As is to be expected, the
construction of~$\mmm$ neither discloses nor requires information about the
status of~$P$ and~$Q$. Even though~$A$ is a Bézout ring, the ideal~$\mmm$
can fail to be finitely generated and hence can fail to be a principal ideal.
\end{example}

\begin{example}If~$A$ is a local ring with group of units~$A^\times$, then~$\mmm = A \setminus A^\times$.\end{example}

\begin{example}\label{ex:maximal-above}We can also use an
arbitrary ideal~$\aaa$ as~$\mmm_0$ instead of the zero ideal. All results in
this section remain valid once ``not~$\varphi$'' is redefined
as~``$\varphi \Rightarrow 1\in\aaa$''; the resulting ideal~$\mmm$ is then a
maximal ideal above~$\aaa$; it is proper in the sense that~$1 \in \mmm
\Rightarrow 1 \in \aaa$, so ``equiconsistent with~$\aaa$''.

The resulting ideal~$\mmm$ can also be obtained by applying the original
version of the construction in the quotient ring~$A/\aaa$ (which is again
countable) and taking the inverse image of the resulting ideal along the
canonical projection~$A \to A/\aaa$.\end{example}


\subsection{Recovering the original construction}

If we can decide whether a finitely generated ideal contains the
unit or not, we can improve on Corollary~\ref{cor:is-prime-max}(a). For instance this is the case for
strongly discrete rings such as the ring~$\ZZ$, more generally for the ring of
integers of every number field, and for polynomial rings over discrete
fields~\cite[Theorem~VIII.1.5]{mines-richman-ruitenburg:constructive-algebra}.

\begin{proposition}\label{prop:with-test}
Assume that for every finitely generated ideal~$\aaa \subseteq A$ we have~$1
\not\in \aaa$ or~$\neg(1 \not\in \aaa)$. Then:
\begin{enumerate}
\item[\textnormal{(a)}] Each ideal~$\mmm_n$ is finitely generated.
\item[\textnormal{(b)}] The ideal~$\mmm$ is detachable.
\end{enumerate}
If even~$1 \in \aaa$ or~$1 \not\in \aaa$ for every finitely generated ideal~$\aaa \subseteq
A$, then:
\begin{enumerate}
\addtocounter{enumi}{2}
\item[\textnormal{(c)}] The ideal~$\mmm$ is maximal in the strong sense that for every element~$x
\in A$,~$x \in \mmm$ or~$1 \in \mmm + (x)$, which is to say that the quotient ring~$A/\mmm$ is a
\emph{geometric field} (every element is zero or invertible).\footnote{This
notion of a maximal ideal, together with the corresponding one of a complete
theory in propositional logic, has been generalized to the concept of a
complete coalition~\cite{schuster-wessel:cie2020,schuster-wessel:jacincpred} for an abstract inconsistency
predicate.}
\end{enumerate}
\end{proposition}

\begin{proof}We verify claim~(a) by induction over~$n$. The case~$n = 0$ is
clear. Let~$n > 0$. By the induction hypothesis, the ideal~$\mmm_{n-1}$ is finitely
generated, hence so is~$\mmm_{n-1} + (x_{n-1})$. By assumption,~$1 \not\in \mmm_{n-1} +
(x_{n-1})$ or~$\neg(1 \not\in \mmm_{n-1} + (x_{n-1}))$. In the first
case~$\mmm_n = \mmm_{n-1} + (x_{n-1})$. In the second case~$\mmm_n =
\mmm_{n-1}$. In both cases
the ideal~$\mmm_n$ is finitely generated.

To verify claim~(b), let an element~$x_n \in A$ be given. By assumption,~$1
\not\in \mmm_n + (x_n)$ or~$\neg(1 \not\in \mmm_n + (x_n))$. Hence~$x_n \in
\mmm$ or~$x_n \not\in \mmm$ by Lemma~\ref{lemma:omnibus}(c).

For claim~(c), let an element~$x_n \in A$ be given. If~$1 \in \mmm_n + (x_n)$,
then also~$1 \in \mmm + (x_n)$. If~$1 \not\in \mmm_n + (x_n)$, then~$x_n \in
\mmm$ by Lemma~\ref{lemma:omnibus}(c).
\end{proof}

Remarkably, under the assumption of Proposition~\ref{prop:with-test}, the ideal~$\mmm$ is detachable even though in
general it fails to be finitely generated. Usually in constructive mathematics, ideals which are not
finitely generated are seldom detachable. For instance the ideal~$\{ x \in
\ZZ \,|\, x = 0 \vee \varphi \} \subseteq \ZZ$ is detachable if and only
if~$\varphi \vee \neg\varphi$.

A consequence of Proposition~\ref{prop:with-test}(a) is that the original
procedure displayed as Equation~(\ref{eq:orig-construction}) on
page~\pageref{eq:orig-construction} is constructively feasible, and that it
coincides with the construction of the maximal ideal~$\mmm$.


\subsection{A more economical description using generators}
\label{sect:more-economical}

There is an equivalent description of the
maximal ideal~$\mmm$ which uses sets~$G_n$ of generators as proxies for the
intermediate ideals~$\mmm_n$~(\flink{§1.Construction-1}):
\begin{align*}
  G_0 &\defeq \emptyset \\
  G_{n+1} &\defeq G_n \cup \{ x_n \,|\, 1 \not\in (G_n \cup \{ x_n \}) \}
\end{align*}
An induction establishes the relation~$(G_n) = \mmm_n$; setting~$G \defeq
\bigcup_{n\in\NN} G_n$, there is the following analogue of
Lemma~\ref{lemma:omnibus}(c).

\begin{lemma}[\flink{§1.Lemma-1-1}]\label{lemma:via-generators}For every number~$n \in \NN$, the following are equivalent:
\begin{enumerate}
\item[(1)] $x_n \in G_{n+1}$.
\item[(2)] $x_n \in G$.
\item[(3)] $1 \not\in (G) + (x_n)$.
\item[(4)] $1 \not\in (G_n) + (x_n)$.
\end{enumerate}
\end{lemma}

In particular, not only do we have that~$(G) = \mmm$, but~$G$ itself is already
an ideal. This description of~$\mmm$ is in a sense more ``economical'' as the
intermediate stages~$G_n$ are smaller (not yet being ideals), enabling
arithmetization in Section~\ref{sect:arithmetization}.


\subsection{Generalization to the subcountable case}
\label{sect:subcountable}

\newcommand{\rightrightharpoonup}{\mathrel{\mathrlap{\rightharpoonup}\mkern1mu\rightharpoonup}}
All results in Section~\ref{sect:constr} carry over mutatis mutandis if~$A$ is
only assumed to be subcountable, that is, if we are only
given a \emph{partially defined} surjection~$\NN \rightrightharpoonup A$.

In
this case, we are given an enumeration~$x_0,x_1,\ldots$ where some~$x_i$
might not be defined; we then define~$\mmm_{n+1} \defeq
\mmm_n + (\{ x_n \,|\, \text{$x_n$ is defined} \wedge 1 \not\in \mmm_n + (x_n) \})$.

The generalization to the subcountable case is particularly useful in the
Russian tradition of constructive mathematics as exhibited by the ef{}fective
topos~\cite{hyland:effective-topos,oosten:realizability,phoa:effective,bauer:c2c},
where many rings of interest are subcountable, including uncountable ones such as the real
numbers~\cite[Prop.~7.2]{hyland:effective-topos}.

The generalization is also useful for
localizations of rings at multiplicative subsets which might not be detachable,
such as, in algebraic geometry, the structure sheaf of a spectrum. This sheaf
is the localization of (the constant sheaf associated to) a given ring at its
\emph{generic filter}~\cite[Section~3.3]{blechschmidt:generalized-spaces}.


\subsection{Interaction with Noetherian hypotheses}

In classical mathematics, a ring is \emph{Noetherian} if and only if every
infinite ascending sequence
\[ \aaa_0 \subseteq \aaa_1 \subseteq \aaa_2 \subseteq \cdots \]
of ideals \emph{stabilizes} in that there is an index~$n$ such that~$\aaa_n =
\aaa_{n+1} = \cdots$. In particular, the construction of a maximal ideal as the
ascending union of the approximations~$\mmm_n$ already levels off at a finite
stage. Constructively, we can reproduce a small fragment of this
finiteness property.

More precisely, in constructive mathematics, the notion of Noetherian ring
splinters into several inequivalent notions~\cite{richman:noetherian,mines-richman-ruitenburg:constructive-algebra,perdry:noetherian,perdry:lazy,perdry-schuster:noetherian,schuster-zappe:noetherian,coquand-lombardi:krull,coquand:invariant,tennenbaum:hilbert,seidenberg:noether,jacobsson-lofwall:standard}. Common to most of them
is that firstly they refer only to finitely generated ideals and that secondly
stabilization is weakened to \emph{stalling}: For instance, the Richman--Seidenberg
condition~\cite[Section~III.2]{mines-richman-ruitenburg:constructive-algebra}
states that every infinite ascending chain
$\aaa_0 \subseteq \aaa_1 \subseteq \cdots$ of finitely generated ideals
\emph{stalls} in that there is an index~$n$ such that~$\aaa_n = \aaa_{n+1}$.
Related conditions allow for different kinds of collections of ideals, for
instance trees~\cite{richman:noetherian}, processes~\cite[Section~3.9]{blechschmidt:phd} or
sheaves of sequences~\cite{coquand-lombardi:krull,coquand:invariant,blechschmidt-oldenziel:multiverse};
but all of these keep the two restrictions, for without them not
even the field with two elements would be provably Noetherian.

Since the approximations~$\mmm_n$ can fail to be finitely generated, these
Noetherian conditions do not apply to the construction of a maximal ideal.
However, even with a properness test as in Proposition~\ref{prop:with-test}
which ensures that they are, their effect of guaranteeing stalling is not of
much use: In typical situations, it is common that~$\mmm_n = \mmm_{n+1}$
without~$\mmm_n$ coinciding with the limit~$\bigcup_k \mmm_k$.

We could ``speed up'' the construction, skipping steps which do not add a new
generator. It is somewhat remarkable that we can do so constructively, even
without a properness test, by setting
\begin{align*}
  \mmm'_0 &\defeq \{ 0 \} \\
  \mmm'_{n+1} &\defeq \mmm'_n + (\{ x_k \,|\,
    k \in I_n \wedge (\forall \ell \in I_n\_ k \leq \ell) \}), \\
  &\qquad\qquad\text{where $I_n \defeq \{ k \in \NN \,|\, x_k \not\in \mmm'_n
  \wedge 1 \not\in \mmm'_n + (x_k) \}$.}
\end{align*}
The modified sequence~$\mmm'_0 \subseteq \mmm'_1 \subseteq \cdots$ stalls only
when it stabilizes. However, even with a properness test, by speeding up we lose
finite generation of the approximations as we cannot determine whether~$I_n$ is
empty or inhabited. Hence the classical
finiteness property is not reproduced in a strong sense.

For the peculiar \emph{anonymous} Noetherian condition~\cite[Definition~3.27]{blechschmidt:phd}, postulating that every
ideal is \emph{not~not} finitely generated, there is the following result;
in the language of Veldman and Bezem, a ``ghost from the lost classical
paradise''~\cite[Section~5.1]{veldman-bezem:ramsey}.

\begin{proposition}\label{prop:fin-anon}If the ring~$A$ is anonymously
Noetherian, it is \emph{not~not} the case that there exists a number~$n \in
\NN$ such that~$\mmm = \mmm_n$.\end{proposition}

\begin{proof}If the ideal~$\mmm$ is finitely generated, then clearly such a
number~$n$ exists. The claim follows from the double contrapositive of this
implication.
\end{proof}

The scope of Proposition~\ref{prop:fin-anon} includes the structure sheaf of
the spectrum of countable reduced
rings~\cite[Proposition~34]{blechschmidt:generalized-spaces}.

That said, for processly Noetherian rings, there is an alternative
construction of a maximal ideal which sidesteps all of these issues and does
not even require countability, if instead an oracle for maximality is available.
Given a finitely generated ideal~$\aaa$, such an oracle advises us whether there is a
element~$x \not\in \aaa$ such that the extension~$\aaa + (x)$ is still proper
or whether all elements~$x$ such that~$\aaa + (x)$ is proper are already
contained in~$\aaa$. A maximal ideal can then be constructed by iteratively
adding generators as suggested by the oracle, similar to the construction of
minimal prime ideals above a given finitely generated ideal in the setting of
Lasker--Noether rings~\cite[Theorem~E]{perdry:noetherian}.


\subsection{An application: Construction of algebraic closures}

Assume that~$A$ is a residue field. Let~$f \in A[X]$ be a nonconstant monic
polynomial. Since~$f$ is nonconstant monic, it is not invertible; thus
Example~\ref{ex:maximal-above} shows that there is a maximal ideal~$\mmm$
above~$(f)$. Hence~$A[X]/\mmm$ is a residue field in which~$f$ has a zero, namely the equivalence class of~$X$.

Iterating this \emph{Kronecker construction}, we obtain a splitting field of~$f$. No
assumption regarding decidability of reducibility has to be made, but in return
the resulting field is only a residue field. Alternatively, a splitting residue field
of~$f$ can be obtained in a single step as the quotient of the universal
splitting
algebra~(\cite[Section~III.4]{lombardi-quitte:constructive-algebra},~\cite[Section~2.1]{pohst-zassenhaus:aant},
\cite{richman:splitting}) of~$f$ by a maximal ideal.

Using either of these constructions, we can obtain an algebraic closure of~$A$:
Let~$f_0,f_1,\ldots$ be an enumeration of all nonconstant monic polynomials over~$A$;
successively apply Kronecker or universal splitting algebra steps; and take the
direct limit to obtain a residue field~$K_0$. Over this field, all the
polynomials with coefficients in~$A$ split into linear factors; but~$K_0$
acquires new polynomials which are not present over~$A$.
If~$g$ is a nonconstant monic polynomial over~$K_0$,
it will \emph{not~not} have a zero in~$K_0$,\footnote{There is a splitting
field~$K_0'$ of~$g$ over~$K_0$ in which~$g$ has a zero~$\alpha$. Since the
coefficients of~$g$ are all algebraic over~$A$, by a standard
lemma~\cite[Corollary~VI.1.5]{mines-richman-ruitenburg:constructive-algebra} also~$\alpha$ is a root of a
nonconstant monic polynomial~$f_i$ over~$A$. This polynomial already splits into linear
factors over~$K_0$, and if~$K_0'$ was an integral domain in that at least one
factor of a vanishing product is already zero, one of these roots would
coincide with~$\alpha$. Hence, by injectivity of the canonical map~$K_0 \to
K_0'$, the polynomial~$g$ would already have a zero in~$K_0$. However,
constructively, we cannot suppose the integral domain condition. Constructively
it is only \emph{not~not} true that~$\alpha$ is one of the zeros of~$f_i$.
This issue is not visible in the account of
Mines, Richman and Ruitenburg~\cite[Theorem~VI.3.5]{mines-richman-ruitenburg:constructive-algebra},
as they work over discrete fields, an assumption we do not make.} so
classically~$K_0$ is the desired algebraic closure.

This closure construction, now fairly standard, is due to
Gilmer~\cite{gilmer:algebraic-closure,richman:splitting,conrad:algebraic-closure}.
Constructively however, it can fail that~$K_0$ is algebraically closed. In this
case the older approach from before Gilmer's innovation can be applied:
We repeat this construction with an enumeration of all nonconstant monic
polynomials over~$K_0$, to obtain a field~$K_1$; then~$K_2$; and so on. The
direct limit~$K_\omega$ of these fields is the desired algebraic
closure---if~$g$ is a nonconstant monic polynomial over~$K_\omega$, its coefficients will
already be elements of some~$K_n$ so that~$g$ will have a zero in~$K_{n+1}$.

Using the technique reviewed in Section~\ref{sect:wlog}, the scope of this
closure construction can be generalized from countable residue fields to
arbitrary residue fields, delivering sheaf models of algebraic closures. This
generalization is also useful in the case of countable residue fields, as it
allows us to make do without potentially noncanonical enumerations of the field
elements, thereby addressing a concern of Coquand~\cite[p.~37]{coquand:potential}.
We leave a detailed comparison to the sheaf models of Mannaa and
Coquand~\cite{mannaa-coquand:alg-closure} as further work.


\subsection{Computational content?}

``Non-informative'', judged Berardi and Valentini who also studied the iterative maximal ideal
construction~\cite[Section~4.2]{berardi-valentini:krivine}. They continue:
``Membership to [the maximal ideal] is a negated predicate. [\ldots\!] We
proved no more than the maximal ideal~$M$ exists, and that we can use it in
constructive reasoning. From the statement~$x \in M$ we will get no witness.''
Negativity is our Lemma~\ref{lemma:omnibus}(c). ``A bad joke'', suggested
another expert on constructive algebra.

Indeed, no computation at all is required for carrying out the iterative
maximal ideal construction; the construction is purely formal and membership to
the resulting ideal is in general not decidable.
That said, we
argue that there is still computational value in the construction.

Firstly, that realizers for statements~``$x \in \mmm$'' are non-informative is only
true in case negation is defined as implication to~$\bot$, whereas we have
defined as implication to~$1 = 0$. While~$\bot$ does not have any realizers at
all, depending on the ring, the statement~``$1 = 0$'' might well admit
meaningful realizers. For instance, a ring of the
form~$B[f^{-1}]$ is trivial if and only if~$f$ is nilpotent, and the
ring~$\ZZ/(X)$ where~$X$ is the subsingleton set~$\{ 1 \,|\, \varphi \}
\subseteq \ZZ$ associated to a truth value~$\varphi$ is trivial if and only
if~$\varphi$ holds.

Secondly and more fundamentally, there is computational value in the
construction in that it enables us to write and structure proofs in the style
of classical mathematics, maintaining the fiction that somehow a maximal ideal
has oracularly partitioned the ring elements into those which are zero
modulo~$\mmm$ and those which are invertible modulo~$\mmm$; while in fact, no
such partition has been computed and all the actual computational work is
carried out by the proofs themselves. We illustrate this point with several
case studies in Section~\ref{sect:krull}.

As further spelled out in Section~\ref{sect:dynalg}, the construction is
closely related to the dynamical approach to maximal ideals. The central
premise of that approach is that we may blithely assume that a given element~$x
\in A$ is zero modulo the maximal ideal if we are also prepared to backtrack
and continue computing in case this assumption later turns out to be
inconsistent and~$x$ is actually invertible modulo the maximal ideal.

This idea is precisely codified by the iterative maximal ideal construction in
that we have the residue field property
\begin{equation}
  \label{eq:char-membership}
  \tag{$\dagger$}
  x \in \mmm \quad\Longleftrightarrow\quad \neg(1 \in \mmm + (x))
\end{equation}
by Lemma~\ref{lemma:omnibus}(c): The elements of~$\mmm$ are exactly those ring
elements for which there is a way to transform the contrary assumption~$1 \in
\mmm + (x)$ to the conclusion~$1 = 0$.

The equivalence~(\ref{eq:char-membership}) expresses the essence of the maximal
ideal construction---only that it cannot serve as a definition because of its
evident circularity. The construction resolves this circularity by
stratification along a given enumeration. Section~\ref{sect:wlog} explains how
set-theoretic forcing facilitates a second resolution which does not require an
enumeration.


\section{On the intersection of all prime ideals}
\label{sect:krull}

Classically, Krull's lemma states that the intersection of all prime ideals is the
\emph{nilradical}, the ideal~$\sqrt{(0)}$ of all nilpotent elements. In our
setup, we have the following substitute concerning complements:
\[ \sqrt{(0)}^c =
  \bigcup_{\substack{\text{$\ppp \subseteq A$}\\\text{$\ppp$ prime}\\\text{$\ppp$ $\neg\neg$-stable}}} \ppp^c =
  \bigcup_{\substack{\text{$\ppp \subseteq A$}\\\text{$\ppp$ prime}\\\text{$\ppp$ radical}}} \ppp^c. \]

\begin{lemma}\label{lemma:x-prime}
Let~$x \in A$. Then there is an ideal~$\ppp \subseteq A$ which is
\begin{enumerate}
\item ``$x$-prime'' in the sense that
$1 \in \ppp \Rightarrow x \in \sqrt{(0)}$ and
$ab \in \ppp \wedge \bigl(b \in \ppp \Rightarrow x \in \sqrt{(0)}\bigr) \Longrightarrow
   a \in \ppp$,
that is, prime if the negations occurring in the definition of ``prime ideal''
are understood as~``$\varphi \Rightarrow x \in \sqrt{(0)}$'',
\item ``$x$-stable'' in the sense that
$\bigl((a \in \ppp \Rightarrow x \in \sqrt{(0)}) \Rightarrow x \in \sqrt{(0)}\bigr)
  \Rightarrow a \in \ppp$,
\item radical,
\item and such that~$x \in \ppp$ if and only if~$x$ is nilpotent.
\end{enumerate}
\end{lemma}

\begin{proof}The localization~$A[x^{-1}]$ is again countable, hence the
construction of Section~\ref{sect:constr} can be carried out to obtain a
maximal (and hence prime) ideal~$\mmm \subseteq A[x^{-1}]$. Every negation
occurring in the terms ``maximal ideal'' and ``prime ideal'' refers to~$1 = 0$
in~$A[x^{-1}]$, which is equivalent to~$x$ being nilpotent.

The preimage of~$\mmm$ under the localization homomorphism~$A \to A[x^{-1}]$ is
the desired~$x$-prime ideal.
\end{proof}

\begin{corollary}[Krull~\cite{krull:ohne}]\label{cor:nilp-prime}Let~$x \in A$ be an element which is not nilpotent. Then there is a
(radical and $\neg\neg$-stable) prime ideal~$\ppp \subseteq A$ such that~$x \not\in \ppp$.
\end{corollary}

\begin{proof}Because~$x$ is not nilpotent, the notions of an~$x$-prime ideal and
an ordinary prime ideal coincide. Hence the claim follows from
Lemma~\ref{lemma:x-prime}.\end{proof}

\begin{theorem}[Krull's separation lemma]Let~$S \subseteq A$ be a multiplicatively closed subset which
does not contain zero. Then there is a
(radical and $\neg\neg$-stable) prime ideal~$\ppp \subseteq A$ such that~$S
\cap \ppp = \emptyset$.
\end{theorem}

\begin{proof}As in the proof of Corollary~\ref{cor:nilp-prime}, the desired
prime ideal is the preimage under the localization morphism~$A \to A[S^{-1}]$
of a maximal ideal constructed in~$A[S^{-1}]$. If~$S$ is not a detachable
subset of~$A$, the localization~$A[S^{-1}]$ can fail to be countable; however,
in any case, it is subcountable so that the iterative maximal ideal
construction can still be carried out (Section~\ref{sect:subcountable}).
\end{proof}

The general case of Krull's separation lemma for arbitrary commutative rings
is, over~\textsc{zf}, equivalent to the Boolean prime ideal
theorem~\cite{banaschweski-erne:krull}.

An essential part of constructive algebra is to devise tools to import
proofs from classical commutative algebra into the constructive
setting.\footnote{Forms of Zorn's Lemma similar to Krull's Lemma
feature prominently in algebra; to wit, in ordered algebra there are the
Artin--Schreier theorem for fields, Levi's theorem for Abelian groups and
Ribenboim's extension to modules. Dynamical algebra aside, to which we will
come back later, these statements have recently gained attention from the angle
of proof theory at large; see, for example,
\cite{rin:ukl,rin:edde,rin:edde:full,wessel:ordering,schuster-wessel:ext,wessel:conred,bon:rib,pow:occ}.}
The following two statements are established test cases exploring the power of
such tools~\cite{schuster:induction,schuster:inductionjournal,persson:constructive-spectrum,powell-schuster-wiesnet:krull,swy:dynprime,schuster-wessel:indeterminacy,banaschweski-vermeulen:radical,richman:trivial-rings,coquand-lombardi:logical,coquand-lombardi-roy:dynamicalmethod}.

\begin{proposition}\label{prop:test-cases}Let~$f \in A[X]$ be a polynomial.
\begin{enumerate}
\item[(a)] If~$f$ is nilpotent in~$A[X]$, then all coefficients of~$f$ are nilpotent in~$A$.
\item[(b)] If~$f$ is invertible in~$A[X]$, then all nonconstant coefficients of~$f$ are nilpotent.
\end{enumerate}
\end{proposition}

These facts have abstract classical proofs employing Krull's lemma as follows.

% NOTE FOR TYPESETTING: It is on purpose that we are not using the proof
% environment here, as we are quoting these classical proofs as objects of
% demonstration. We are not actually using these proofs in our development, we
% are just referencing them.
\begin{quote}\small
  \textbf{Proof of (a).} Simple induction over the formal degree of~$f$ if~$A$ is
  reduced; the general case reduces to this one: For every prime ideal~$\ppp$,
  the coefficients of~$f$ vanish over the reduced ring~$A/\ppp$. Hence they are
  contained in all prime ideals and are thereby
  nilpotent.\medskip

  \textbf{Proof of (b).} Simple induction if~$A$ is an
  integral domain; the general case reduces to this one: For every prime
  ideal~$\ppp$, the nonconstant coefficients of~$f$ vanish over the integral
  domain~$A/\ppp$. Hence they are contained in all prime ideals
  and are thereby nilpotent.
\end{quote}

Both statements admit direct computational proofs which do not
refer to prime ideals; the challenge is not to find such proofs, but rather to
imitate the two classical proofs above constructively, staying as close as
possible to the original. It is remarkable that the construction of
Section~\ref{sect:constr} meets this challenge at all, outlined as follows, despite its fundamental
reliance on nondetachable subsets.

We continue assuming that~$A$ is countable:
Section~\ref{sect:wlog} indicates how this assumption can be dropped in quite
general situations, while for the purposes of specific challenges such as Proposition~\ref{prop:test-cases} we could also
simply pass to the countable subring generated by the polynomial coefficients
or employ the method of indeterminate coefficients---the special instance of
Proposition~\ref{prop:test-cases}(a) for the countable ring~$A =
\ZZ[A_0,\ldots,A_n]/(\ldots)$, where we mod out the equations expressing that
the indeterminate polynomial~$\sum_{i=0}^n A_i X^i$ is nilpotent of
index at most~$m$, implies all other such instances, and similarly for
Proposition~\ref{prop:test-cases}(b).

\begin{proof}[Proof of Proposition~\ref{prop:test-cases}]
The first claim follows from a simple induction if~$A$ is a reduced
ring.
%
In the general case, write~$f = a_n X^n + a_{n-1} X^{n-1} + \cdots + a_0$. Let~$\ppp$
be a radical~$a_n$-prime ideal as in Lemma~\ref{lemma:x-prime}. Since~$A/\ppp$
is reduced, the nilpotent coefficient~$a_n$ vanishes over~$A/\ppp$. Thus~$a_n \in \ppp$,
hence~$a_n$ is nilpotent. Since the polynomial~$f - a_n X^n$ is again
nilpotent, we can continue by induction.

The second claim follows by a simple inductive argument if~$A$ is an
integral domain with double negation stable equality.
%
In the general case, write~$f = a_n X^n + \cdots + a_0$
and assume~$n \geq 1$. To reduce to the integral situation, let~$\ppp$ be
an~$a_n$-prime ideal as in Lemma~\ref{lemma:x-prime}.
With negation~``$\neg\varphi$'' understood as~``$\varphi \Rightarrow a_n \in
\sqrt{(0)}$'', the quotient ring~$A/\ppp$ is an integral domain with double
negation stable equality.
Hence~$a_n = 0$ in~$A/\ppp$, so~$a_n \in \ppp$ whereby~$a_n$ is nilpotent. The
polynomial~$f - a_n X^n$ is again invertible in~$A[X]$ (since the group of
units is closed under adding nilpotent elements) so that we can continue by
induction.
\end{proof}

Just as Corollary~\ref{cor:nilp-prime} is a constructive substitute
for the recognition of the intersection of all prime ideals as the nilradical,
the following proposition is a substitute for the classical fact that
the intersection of all maximal ideals is the Jacobson radical.
%
As is customary in constructive
algebra~\cite[Section~IX.1]{lombardi-quitte:constructive-algebra}, by
\emph{Jacobson radical} we mean the ideal
$\{ x \in A \,|\, \forall y \in A\_ 1 - xy \in A^\times \}$.
%An element~$x$ is said to be \emph{apart} from it iff
%there is an element~$y \in A$ such that~$1-xy$ is not invertible.
% In general, this condition is stronger than~$x$ merely not being an element of~$J$.

\begin{proposition}\label{prop:jac}Let~$x \in A$. If~$x$ is \emph{apart} from the Jacobson radical (that is, $1-xy \not\in A^\times$ for some element~$y$), then
there is a maximal ideal~$\mmm$ such that~$x \not\in \mmm$.
\end{proposition}

\begin{proof}The standard proof as
in~\cite[Lemma~IX.1.1]{lombardi-quitte:constructive-algebra} applies: There is
an element~$y$ such that~$1-xy$
is not invertible. By Example~\ref{ex:maximal-above}, there is an ideal~$\mmm$
above~$\aaa \defeq (1-xy)$ which is maximal not only as an ideal of~$A/\aaa$
(where~``$\neg\varphi$'' means~``$\varphi \Rightarrow 1 \in \aaa$'') but also as an
ideal of~$A$ (where~``$\neg\varphi$'' means~``$\varphi \Rightarrow 1 = 0$''). If~$x
\in \mmm$, then~$1 = (1-xy) + xy \in \mmm$; hence~$x \not\in \mmm$.
\end{proof}

The two test cases presented in Proposition~\ref{prop:test-cases} only concern
prime ideals. In contrast, the following example crucially rests on the
maximality of the ideal~$\mmm$.

\begin{proposition}[\flink{§2.Proposition-2-6}]\label{prop:surj-matrix}Let~$M \in A^{n \times m}$ be a matrix with more rows than
columns. Assume that the induced linear map~$A^m \to A^n$ is surjective.
Then~$1 = 0$.
\end{proposition}

\begin{proof}By passing to the quotient~$A/\mmm$, we may assume that~$A$ is a
residue field. In this case the claim is standard linear algebra:

If any of the matrix entries
is invertible, the matrix could be transformed by elementary row and
column operations to a matrix of the form~$\left(\begin{smallmatrix}1 & 0 \\ 0 &
M'\end{smallmatrix}\right)$, where the induced linear map of the submatrix~$M'$ is again
surjective. Thus~$1 = 0$ by induction.

Hence by the residue field property all matrix entries are zero.
But the vector $(1,0,\ldots,0)\in A^n$ still
belongs to the range of $M=0$, hence~$1=0$ by~$n > 0$.
\end{proof}

After removing the countability assumption by the technique of
Section~\ref{sect:wlog}, we display an unrolled version of this proof of
Proposition~\ref{prop:surj-matrix} on
page~\pageref{proof:surj-matrix-explicit}.

A more significant case study is Suslin's lemma, the fundamental and originally
non-constructive ingredient in his second solution of Serre's
problem~\cite{suslin:structure}. The classical proof, concisely recalled in
Yengui's constructive account~\cite{yengui:maximal}, reduces modulo
maximal ideals. The construction of Section~\ref{sect:constr} offers a
constructive substitute. However, since gcd computations
are required in the quotient rings, it is not enough that they are residue
fields; they need to be geometric fields. Hence our approach has to be combined
with the technique variously known as \emph{Friedman's trick}, \emph{nontrivial
exit continuation} or \emph{baby version of Barr's theorem} in order to yield a
constructive
proof~\cite{friedman:trick,murthy:classical-proofs,barr:without-points,blechschmidt:generalized-spaces}.
We have chosen to not undertake a formalization of this approach; but we
nevertheless believe that, after removing the countability assumption using the
technique of Section~\ref{sect:wlog} and unwinding all auxiliary definitions,
we recover Yengui's proof.

Although not the focus of this text, we have also analyzed classical proofs
making use of minimal prime ideals; see Remark~\ref{remark:minimal-prime-ideals} below.


\section{Formalization in weaker foundations}
\label{sect:arithmetization}

The construction presented in Section~\ref{sect:constr} crucially rests on the
flexibility of nondetachable subsets: In absence of additional
assumptions as in Proposition~\ref{prop:with-test},
we cannot give the ideals~$\mmm_n$ by decidable
predicates~$A \to \{0,1\}$---without additional hypotheses on~$A$, membership of the
ideals~$\mmm_n$ is not decidable. As such, the construction is
naturally formalized in intuitionistic set theories such as~\textsc{czf}
or~\textsc{izf}, which natively support such flexible subsets.

In this section, we explain how with some more care, the construction can also
be carried out in much weaker foundations such as Heyting
arithmetic~\textsc{ha}. While formulation in classical Peano arithmetic~\textsc{pa}
is routine, the development in~\textsc{ha} crucially rests on a specific
feature of the construction, namely that the condition for membership is a
negative condition.

To set the stage, we specify what we mean by a \emph{ring} in the context of
arithmetic. One option would be to decree that an arithmetized ring should be a single
natural number coding a finite set of ring elements and the graphs of the
corresponding ring operations; however, this perspective is too narrow, as we
also want to work with infinite rings.

Instead, an arithmetized ring should be given by a ``formulaic setoid with ring
structure'', that is: by a formula~$A(n)$ with free
variable~$n$, singling out which natural numbers constitute
representatives of the ring elements; by a formula~$E(n,m)$ describing which
representatives are deemed equivalent; by a formula~$Z(n)$ singling out
representatives of the zero element; by a formula~$P(n,m,s)$ singling out
representatives~$s$ of sums; and so on with the remaining data constituting
a ring; such that axioms such as\par
{\vspace*{-1.2em}\small\begin{align*}
  \forall n\_ & Z(n) \Rightarrow A(n) && \text{``every zero representative belongs to the ring''} \\
  \exists n\_ & Z(n) && \text{``there is a zero representative''} \\
  \forall n,m\_ & Z(n) \wedge Z(m) \Longrightarrow E(n,m) && \text{``every two zero representatives are equivalent''} \\
  \forall z,n\_ & Z(z) \wedge A(n) \Longrightarrow P(z,n,n) && \text{``zero is neutral with respect to addition''}
\end{align*}}%
hold. This conception of arithmetized rings deviates from the usual definition
in reverse mathematics~\cite[Definition~III.5.1]{simpson:subsystems} to support
quotients even when~\textsc{ha} cannot verify the existence of
canonical representatives of equivalence classes. It is related to the notion
of ring objects in the initial arithmetic universe obtained as the exact
completion of an appropriate Skolem theory~\cite{maietti:au,vickers:sketches}.
A similar, but more specialized, notion has been considered by
Perdry~\cite[Section~2]{perdry:lazy}.

Although first-order arithmetic cannot quantify over ideals of arithmetized
rings, specific ideals can be given by formulas~$I(n)$ such that axioms such as
{\small\begin{align*}
  \forall n\_ & I(n) \Rightarrow A(n) && \text{``$I \subseteq A$''} \\
  \exists n\_ & Z(n) \wedge I(n) && \text{``$0 \in I$''}
\end{align*}}%
hold. It is in this sense that we are striving to adapt the construction of
Section~\ref{sect:constr} to describe a maximal ideal.

In this context, we can arithmetically imitate any set-theoretic description of
a single ideal as a subset cut out by an explicit first-order formula. However, for
recursively defined families of ideals, we require a suitable recursion
theorem: If we are given (individual formulas~$M_n(x)$ indexed by numerals
representing) ideals~$\mmm_0,\mmm_1,\mmm_2,\ldots$, we cannot generally
form~$\bigcup_{n\in\NN} \mmm_n$, as the naive formula~``$\bigvee_{n\in\NN} M_n(x)$''
representing their union would have infinite length. We can take the union only
if the family is \emph{uniformly represented} by a single formula~$M(n,x)$ (expressing
that~$x$ represents an element of~$\mmm_n$).

This restriction is a blocking issue for arithmetizing the
construction of the chain~$\mmm_0 \subseteq \mmm_1 \subseteq \cdots$
of Section~\ref{sect:constr}. Because~$\mmm_n$ occurs in the
definition of~$\mmm_{n+1}$ in negative position, naive arithmetization
results in formulas of unbounded logical complexity, suggesting that
a uniform definition might not be possible.

This issue has a counterpart in type-theoretic foundations of mathematics,
where the family~$(\mmm_n)_{n \in \NN}$ cannot be given as an inductive family
(failing the positivity check), and is also noted, though not resolved, in
related work~\cite[p.~11]{herbelin-ilik:henkin}.
The issue does not arise in the context of~\textsc{pa}, where the law of
excluded middle allows us to bound the logical complexity: We can blithely define
the joint indicator function~$g(n,i)$ for the sets~$G_n$ (such that~$G_n = \{
x_i \,|\, i \in \NN, g(n,i) = 1 \}$) of Lemma~\ref{lemma:via-generators} by the recursion
\begin{align*}
  g(0,i) &= 0 \\
  g(n+1,i) &= \begin{cases}
    1, & \text{if $g(n,i) = 1 \vee (i = n \wedge 1 \not\in
    (g(n,0)x_0,\ldots,g(n,n{-}1)x_{n-1},x_n))$} \\
    0, & \text{else.}
  \end{cases}
\end{align*}
This recursion can be carried out within~\textsc{pa} since the recursive step
only references the finitely many values~$g(n,0),\ldots,g(n,i)$.
Heyting arithmetic, however, does not support this case distinction. The
formalization of the construction in~\textsc{ha} is only unlocked by the following
direct characterization.

\begin{lemma}\label{lemma:uniform-char}(In the setting of Section~\ref{sect:more-economical}.)
For every finite binary sequence~$v = v_0 \ldots v_{n-1}$, let~$\aaa_v$ be the
ideal~$(v_0x_0,\ldots,v_{n-1}x_{n-1},x_n)$. Then:
\begin{enumerate}
\item[(a)] For every such sequence~$v = v_0 \ldots v_{n-1}$, if
$\bigwedge_{i=0}^{n-1} (v_i = 1 \Leftrightarrow 1 \not\in \aaa_{v_0 \ldots v_{i-1}})$,
then~$\aaa_v = (G_n) + (x_n)$.
In particular, in this case~$x_n \in G$ if and only if~$1 \not\in \aaa_v$.
\item[(b)] For every natural number~$n \in \NN$,
\vspace*{-1.2em}
\[ x_n \in G \quad\Longleftrightarrow\quad \neg
  \exists v \in \{0,1\}^n\_
    1 \in \aaa_v \wedge
      \bigwedge_{i=0}^{n-1} (v_i = 1 \Leftrightarrow 1 \not\in \aaa_{v_0 \ldots v_{i-1}}). \]
\end{enumerate}
\end{lemma}

\begin{proof}\belowdisplayskip=-18pt The first part is by induction, employing the equivalences of
Lemma~\ref{lemma:via-generators}. The second rests on the tautology
$\neg\alpha \Longleftrightarrow \neg(\alpha \wedge (\varphi \vee \neg\varphi))$:
\begin{align*}
  x_n \in G &
  \Longleftrightarrow \neg\bigl(1 \in (G_n) + (x_n)\bigr)
  \Longleftrightarrow \neg\bigl(1 \in (G_n) + (x_n) \ \wedge\ \bigwedge_{i=0}^{n-1} (x_i \in G \vee x_i \not\in G)\bigr) \\
  & \Longleftrightarrow \neg\exists v \in \{0,1\}^n\_
    \Bigl(1 \in (G_n) + (x_n) \ \wedge\ \bigwedge_{i=0}^{n-1} (v_i = 1
    \Leftrightarrow x_i \in G)\Bigr) \\
  & \Longleftrightarrow \neg\exists v \in \{0,1\}^n\_
    \Bigl(1 \in \aaa_v \ \wedge\ \bigwedge_{i=0}^{n-1} (v_i = 1
    \Leftrightarrow 1 \not\in \aaa_{v_0 \ldots v_{i-1}})\Bigr)
\end{align*}
\end{proof}

\noindent
Condition~(b) is manifestly formalizable in
arithmetic, uniformly in~$n$.


\section{Expanding the scope to general rings}
\label{sect:wlog}

The iterative construction presented in Section~\ref{sect:constr}
can be employed to constructively recast suitable classical proofs in
commutative algebra which rely on maximal ideals. However, the construction requires an enumeration~$\NN
\twoheadrightarrow A$ of the ring elements. This section deals with the case
that no such enumeration exists or is available.

As a first observation, we notice that without much difficulty, the same technique can be used in situations where the
maximality condition~``$1 \not\in \mmm + (x)$ implies~$x \in \mmm$''
is required only for a finite number~$x_0,\ldots,x_{n-1}$ of ring elements
fixed beforehand. In this case we can apply the construction of Section~\ref{sect:constr} to
this finite enumeration and use the resulting ideal~$\mmm_n$ as a partial
substitute for an intangible maximal ideal.

We propose to employ tools from pointfree topology to
widen the applicability of this partial
substitute to cases where the inspected ring elements are
not fixed beforehand. The idea is to dynamically grow a partial enumeration as
needed: When following a given proof, we initially approximate the unavailable
complete enumeration~$\NN \twoheadrightarrow A$ by the nowhere-defined partial
function~$f : \NN \rightharpoonup A$. When the proof requires
that some particular element~$x_0 \in A$ is contained in the image of~$f$, we grow~$f$ to
the more-defined partial function~$f'$ mapping~$0$ to~$x_0$. When the proof
requires some further element~$x_1 \in A$ to be part of the enumeration, we further refine~$f'$
to the partial function~$f''$ with~$f''(0) = x_0$, $f''(1) = x_1$.
As the proof runs its course, we pass to better and better approximations on an
on-demand basis.

To make this informal idea precise, we employ \emph{constructive forcing} to
pass from the base universe~$V$ to a suitably enlarged universe~$V^\nabla$. In
this larger universe, the multitude of better and better finite approximations to a
hypothetical enumeration of~$A$ is reified as a single coherent entity, the
\emph{generic enumeration} of~$A$. On the one hand, the existence of this enumeration
exhibits~$V^\nabla$ as a better (more well-adapted) universe to work in than the
base~$V$. On the other hand, the extended universe is still close to~$V$ in that the two universes
validate the same bounded first-order statements. We can hence work in~$V^\nabla$ to
deduce results about~$V$. Even in case that~$V$ validates classical logic---an
assumption we do not make---the enlarged universe typically only validates
intuitionistic logic.

Constructive forcing is usually described in the language of sheaves and
toposes~\cite{palmgren:css,grayson:forcing,streicher:forcing,yamamoto:forcing,scedrov:forcing,tierney:forcing,blass-scedrov:forcing,roberts:class-forcing}
and closely linked to pointfree topology. For surveys of these topics, we
refer to~\cite{blechschmidt:generalized-spaces,johnstone:art,johnstone:point,vickers:continuity,vickers:locales-toposes,belanger-marquis:pointless,johnstone:baby-elephant}.
The objective of this section is to give a purely syntactical account, not
employing categorical language, having the requirements of predicative
mathematics~\cite{maietti:au,vickers:sketches,crosilla:predicativity} in mind
and focusing
on computational content. Related work
includes~\cite[Section~2.4]{avigad:forcing},~\cite{coquand:goodman},~\cite[Section~2.3]{renardel-de-lavalette:bi}
and~\cite{sato:forcing}.

We circumvent the actual construction of~$V^\nabla$, which would require sheaves, by
instead directly giving a translation~$\varphi \mapsto \varphi^\nabla$ of
formulas in such a way that a sentence~$\varphi$ holds in~$V^\nabla$
iff~$\varphi^\nabla$ holds in~$V$. This translation is a parametric
generalization of the venerable double-negation translation. In fact, depending
on the \emph{forcing notion} used, we recover
\begin{enumerate}
\item[(1)] the standard double-negation translation, where
existential quantification is translated to impossibility of a counterexample
(``$\exists \mapsto \neg\forall\neg$'');
\item[(2)] the refined translation sometimes known as Friedman's nontrivial
continuation trick, as used in one of the proofs of Barr's theorem; and
\item[(3)] the topological translation, where existential quantification is
translated to local existence.\footnote{For more on the topological
translation, see~\cite[Section~4.3]{blechschmidt:filmat}
or~\cite[Section~2.4]{blechschmidt:generalized-spaces}. For instance, the
translation of the (not constructively provable) claim ``every real symmetric
matrix has an eigenvector'' is the (refutable) statement ``for every continuous
family of real symmetric matrices, eigenvectors can locally be picked in a
continuous fashion'', while the translation of the (constructively provable)
claim ``every real symmetric matrix does \emph{not~not} have an eigenvector''
is the (constructively provable) statement ``for every continuous family of real
symmetric matrices, on an open dense set of parameter values, eigenvectors can
locally picked in a continuous fashion''. In one direction, the topological
translation enables quick nonprovability results, while in the other it enables
continuous globalizations.}
\end{enumerate}

The translation of formulas is accompanied by a translation of proofs (with
just a polynomial increase in length), ensuring that if a set of axioms
entails a certain conclusion, the set of translated axioms entails the
translated conclusion. Translated proofs admit a direct computational
interpretation, as programs running in a general \emph{eventually monad} described
below. Specific versions of the eventually monad have been studied in the
reactive programing
community~\cite{paykin-krishnaswami-zdancewic:event,cave-ferreira-panangaden-pientka:frp}.


\subsection{Forcing notions}\label{sect:forcing-notions} The particular flavor of forcing is determined
by its \emph{notion of forcing}. This is a preorder~$(L,{\preccurlyeq})$ equipped with a
\emph{covering system} (Definition~\ref{defn:covering-system} below). The
elements of~$L$ are called \emph{forcing conditions} and are regarded
as partial approximations to (perhaps fictitious) ideal objects. The
relation~$\tau \preccurlyeq \sigma$ expresses that~$\tau$ is a
refinement of~$\sigma$, that is that~$\tau$ contains more information
than~$\sigma$ and hence restricts the fictitious ideal objects
approximated by~$\tau$ more strongly than~$\sigma$ does, just as~$[3.14, 3.15]$ is a smaller
interval than~$[3.1, 3.2]$.

The associated covering system specifies which kinds of refinements
we are prepared to make. In the following definition, the
expression~${\downarrow}\sigma$ denotes the set~$\{ \tau \in L \,|\, \tau
\preccurlyeq \sigma \}$ of all refinements of~$\sigma$ and the
expression~${\downarrow}R$ denotes the downward closure of a subset~$R \subseteq L$, that is the
set~$\{ \tau \in L \,|\, \exists \sigma \in R\_ \tau \preccurlyeq \sigma \} =
\bigcup_{\sigma \in R} {\downarrow}\sigma$. For a set~$M$, we denote its
powerset (or powerclass) by~$P(M)$.

\begin{definition}[{\cite[p.~24]{joyal-tierney:grothendieck}}, \flink{§4.§4-1.Definition-4-1}]\label{defn:covering-system}A \emph{covering system} on a
poset~$L$ consists of a set~$\Cov(\sigma) \subseteq P({\downarrow}\sigma)$
of \emph{coverings} for each element~$\sigma \in L$ subject only to the
following stability condition:
If~$\tau \preccurlyeq \sigma$ and~$R \in \Cov(\sigma)$, there should be a
covering~$S \in \Cov(\tau)$ such that~$S \subseteq {\downarrow}R$.
\end{definition}

\begin{definition}[\flink{§4.§4-1.Definition-4-2}]
A \emph{filter} of a forcing notion~$(L,\mathrm{Cov})$
is a subset~$F \subseteq L$ such that
\begin{enumerate}
\item $F$ is upward-closed (``closed under coarser elements''): if~$\tau \preccurlyeq \sigma$ and if~$\tau \in F$,
then~$\sigma \in F$;
\item $F$ is downward-directed: $F$ is inhabited, and if~$\alpha,\beta \in F$,
then there is a common refinement~$\sigma \preccurlyeq \alpha,\beta$ such
that~$\sigma \in F$; and
\item $F$ splits the covering system: if~$\sigma \in F$ and~$R \in
\Cov(\sigma)$, then~$\tau \in F$ for some~$\tau \in R$.
\end{enumerate}
\end{definition}

It can well happen that a forcing notion does not admit any filters; the
purpose of a forcing notion is to give rise to a forcing extension of the
universe in which a filter can always be found. The canonical filter living in
the extended universe is called the \emph{generic filter}.

\begin{example}[\flink{§4.§4-1.Example-4-3}]\label{ex:notion-enum}To force the existence of an enumeration
of the elements of a (perhaps uncountable) set~$X$, let~$L \defeq X^*$ be the set of finite lists
of elements of~$X$. We picture a list~$x_0\ldots x_{n-1}]$ as code for the
partial enumeration~$f : \NN \rightharpoonup X$ given by~$f(i) = x_i$
for~$i=0,\ldots,n-1$, and declare~$\tau \preccurlyeq \sigma$ iff~$\sigma$ is a prefix
of~$\tau$, expressing that the partial enumeration coded by~$\tau$ refines the
one coded by~$\sigma$.

For each list~$\sigma \in L$, we decree that its coverings are the set
$\{ \sigma y \,|\, y \in X \}$
and, for each element~$a \in X$, the set
$\{ \sigma \sigma' \,|\, \sigma' \in L, a \in \sigma \sigma'
\}$. (By~$\sigma y$, we mean the enlarged list with~$y$ as an
added element at the end. By~$\sigma \sigma'$, we mean the concatenation
of the lists~$\sigma$ and~$\sigma'$. We write~$a \in \nu$ if and only if the
list~$\nu$ has~$a$ among its terms.)
The first kind of covering expresses that we are prepared to grow a partial
enumeration in order to make it more defined, the second to ensure
that any given element~$a$ is enumerated.

The filters of this forcing notion
are in canonical one-to-one correspondence with
surjections~$\NN \twoheadrightarrow X$, by mapping a filter~$F$ to the gluing
of the partial enumerations coded by the lists in~$F$. These partial
enumerations indeed agree on their common domain of definition by the
directedness condition; and because~$F$ splits the covering system, the gluing
of the partial enumerations is total and surjective. Conversely, a surjection corresponds to the filter of
its finite prefixes. In case that~$X$ is uncountable, there are no filters, and
this direct correspondence degenerates to the unique bijection between
empty sets.
\end{example}

\begin{example}\label{ex:notion-max}We can also directly force the existence of a maximal ideal,
instead of first forcing the existence of an enumeration and then applying the
Krivine construction in the enlarged universe. (The relation of these two ways
of acquiring a maximal ideal is explored in
Proposition~\ref{prop:mmm-nnn}.) To this end, let~$L$ be the
poset of finitely generated ideals of~$A$ ordered by reverse inclusion,
and for each element~$\aaa \in L$, let its collection of coverings be
\[\Cov(\aaa) \defeq
  \Bigl\{ \{ \aaa + (x) \} \cup \{ \aaa + (u) \,|\, u \in A, \exists v \in A\_ u + vx = 1 \}
  \,\Big|\, x \in A \Bigr\}
  \cup
  \Bigl\{ \{ \aaa \,|\, 1 = 0 \} \,\Big|\, 1 \in \aaa \Bigr\}.
\]
The first kind of covering expresses that we are prepared to grow partial
approximations exactly as the strong maximality condition ``$x \in \mmm$ or~$1
\in \mmm + (x)$'' would suggest: An approximation~$\aaa$ can grow
to~$\aaa' = \aaa+(x)$ (ensuring~$x \in \aaa'$), or to~$\aaa' = \aaa+(u)$
where~$u \in A$ is such that~$u + vx = 1$ for some~$v \in A$ (ensuring~$1 \in
\aaa' + (x)$). The second kind of covering implements the objective~``$1 \in \mmm
\Rightarrow 1 = 0$''.

The filters of this forcing notion
are in canonical one-to-one correspondence with
those ideals~$\mmm$ of~$A$ which are maximal in the strong sense that
\[
  1 \in \mmm \Longrightarrow 1 = 0
    \quad\text{and}\quad
  x \in \mmm \,\vee\, 1 \in \mmm + (x).
\]
The correspondence is by mapping a filter~$F$ to the ideal~$\bigcup F$
and conversely by mapping a maximal ideal~$\mmm$ to the filter of finitely
generated ideals contained in~$\mmm$.
\end{example}

\begin{example}\label{ex:notion-negneg}To recover the double-negation translation, let~$L$ be the
trivial poset containing just a single element~$\star$ and decree
\[ \Cov(\star) \defeq \bigl\{ \{ \star \,|\, \varphi \} \cup \{ \star \,|\, \neg\varphi \} \,\big|\, \varphi \in \Omega \bigr\}
\quad\text{(where~$\Omega$ is the set of truth values).} \]
This definition expresses that we are prepared, for every truth value~$\varphi
\in \Omega$, to assume~$\varphi$ or to assume~$\neg\varphi$.

This forcing notion has at most one filter, the set~$L$ itself. This set is a
filter if and only if the law of excluded middle holds.
\end{example}

\begin{example}\label{ex:notion-lindenbaum}Let~$\TT$ be a coherent (or
geometric) propositional theory~\cite[Definition~D1.1.3]{johnstone:elephant},
such as the theory of prime ideals of a given ring, and let~$L$ be its
\emph{Lindenbaum algebra}, the set of formulas in the language of~$\TT$ modulo
provable equivalence, endowed with the ordering where~$[\varphi] \preccurlyeq
[\psi]$ if and only if~$\varphi \vdash \psi$ modulo~$\TT$. In the coherent
case, we decree
\[ \Cov([\varphi]) \defeq \bigl\{ \{ [\psi_1],\ldots,[\psi_n] \} \,\big|\,
  n \geq 0,\,\text{$\varphi \dashv\vdash (\psi_1 \vee \cdots \vee \psi_n)$ modulo~$\TT$}
  \bigr\}; \]
in the geometric case, we decree
\[ \Cov([\varphi]) \defeq \bigl\{ M \in P({\downarrow}[\varphi]) \,\big|\,
  \text{$\varphi \vdash \bigl(\bigvee_{K \in M} \bigvee_{\psi \in K} \psi\bigr)$ modulo~$\TT$}
  \bigr\}. \]
The filters of this forcing notion are in canonical one-to-one correspondence
with models of the theory~$\TT$; an element~$[\varphi] \in L$ is read as
partial knowledge about a (perhaps fictitious) model of~$\TT$.
For instance, if~$\TT$ is the theory of strong
prime ideals of a given ring~$A$, with propositional symbols~$P_x$
(interpreted as~``$x$ is contained in the prime ideal''), we are prepared to
refine~$[P_{xy}]$ to~$[P_x]$ and to~$[P_y]$ (expressing the objective~``$xy \in
\ppp \Rightarrow x \in \ppp \vee y \in \ppp$'').

To accommodate non-propositional theories with sorts, such as the theory of
rings or of local rings, the concept of forcing notion is not
sufficiently flexible. To handle this case, we need to generalize from posets
equipped with covering systems to \emph{sites}, categories equipped with
Grothendieck coverages.
\end{example}

% XXX only a preorder?
\begin{example}\label{ex:notion-entrel}Let~$({\vdash})$ be a finitary
multi-conclusion entailment
relation~\cite{lorenzen:investigations,neuwirth:investigations,cederquist-coquand:entdistr,scott:com,rin:edde:full,rinaldi-wessel:cut}
or a geometric entailment relation~(\cite[Section~3]{schuster-wessel:krull},~\cite{wessel:points}) on a set~$S$.
We equip the set~$L \defeq P_\omega(S)$ of
finitely enumerable (Kuratowski-finite) subsets of~$S$ with the following
ordering: $\mathcal{A} \preccurlyeq \mathcal{B}$ iff~$\mathcal{A} \vdash b$ for every
element~$b \in \mathcal{B}$. For each pair~$(\mathcal{A},\mathcal{B})$ such
that~$\mathcal{A} \vdash \mathcal{B}$, we declare that the set~$\{ \mathcal{A}
\cup \{ b \} \,|\, b \in \mathcal{B} \}$ should be a covering of~$\mathcal{A}$.
%(In the case of a geometric entailment relation, we allow~$\mathcal{B}$ to not
%be finitely enumerable here.)

For this forcing notion, there is a canonical one-to-one correspondence between
the filters of~$L$ and the ideals of the entailment relation: If~$F \subseteq
L$ is a filter, then~$\bigcup F$ is an ideal. If~$\nu \subseteq S$ is an ideal,
then~$\{ \mathcal{A} \in P_\omega(S) \,|\, \mathcal{A} \subseteq \nu \}$ is a
filter.

For suitable choices of the entailment relation~$({\vdash})$, we recover the
forcing notions of several of the earlier examples. For instance, up to
inessential details (``Morita equivalence''), the forcing notion of
Example~\ref{ex:notion-lindenbaum} is the special case where~$S$ is the set of
atomic propositions and where~$\mathcal{A} \vdash \mathcal{B}$
iff~$\bigwedge_{\varphi \in \mathcal{A}} \varphi \vdash \bigvee_{\psi \in
\mathcal{B}} \psi$ modulo~$\TT$. The forcing notion of Example~\ref{ex:notion-max} is the
special case where the entailment relation is that
of~\cite[p.~87]{schuster-wessel:krull}.
\end{example}

\begin{example}\label{ex:notion-scott}Let~$(P,{\leq})$ be a complete lattice and let~$\Incbare$
be a Scott-open predicate on~$P$ as in~\cite{wessel-schuster:radical}. Then the
opposite lattice of~$P$ becomes a forcing notion with coverings given by
\[
  \Cov(\sigma) \defeq \bigl\{ \emptyset \,\big|\, \Inc{\sigma} \bigr\} \cup
    \bigl\{ \{ \sigma \vee \nu \} \cup \{ \sigma \vee \nu' \,|\, \nu' \in
    \overline{\nu} \} \,\big|\, \nu \in P \bigr\},
\]
where the joins are computed in~$P$ and~$\overline{\nu}$ denotes the pseudo-complement of~$\nu$ as
in~\cite[Equation~(6)]{wessel-schuster:radical}, that is the set of those
elements~$\nu' \in L$ such that~$\Inc{(\nu \vee \nu')}$.

The filters of this forcing notion are in canonical one-to-one correspondence with
the proper~$\Incbare$-complete elements of~$P$, that is those elements~$\alpha$
with~$\neg \Inc{\alpha}$ for which the disjunction
\[ \nu \leq \alpha \quad\text{or}\quad \Inc{(\alpha \vee \nu)} \]
holds for all elements~$\nu \in P$. The correspondence is by mapping a
filter~$F$ to its join~$\bigvee F \in P$ and conversely by mapping
a proper~$\Incbare$-maximal element~$\alpha$ to the filter~${\downarrow}\alpha$.

If~$P$ is algebraic, that is if every element is the join of the compact
elements below it, we can restrict this covering system to the poset~$KP$ of
compact elements of~$P$:
\[
  \Cov_{KP}(\sigma) \defeq \bigl\{ \emptyset \,\big|\, \Inc{\sigma} \bigr\} \cup
    \bigl\{ \{ \sigma \vee \nu \} \cup \{ \sigma \vee \nu' \,|\, \nu' \in
    \overline{\nu} \cap KP \} \,\big|\, \nu \in KP \bigr\}.
\]
The one-to-one correspondence from above then restricts to a correspondence
between the filters of~$((KP)^\mathrm{op},\mathrm{Cov}_{KP})$ and those proper
elements~$\alpha$ of~$P$ for which the disjunction~``$\nu \leq \alpha \vee
\Inc{(\alpha \vee \nu)}$'' holds for all elements~$\nu \in KP$. In this way we can
recover several other examples for forcing notions. For instance,
Example~\ref{ex:notion-max} is the special case where~$P$ is the complete lattice
of all ideals of~$A$ and~$\Inc{\aaa}$ denotes~$1 \in \aaa$.
\end{example}

\begin{remark}Classical set-theoretic forcing
does without an explicit specification of coverings because implicitly the
\emph{double negation topology} is used:
\[ \Cov(\sigma) \defeq \{ M \in P({\downarrow}\sigma) \,|\,
  \forall \tau \preccurlyeq \sigma\_ \neg\neg \exists \nu \preccurlyeq \tau\_ \nu \in M
  \}. \]
Up to the double negation which disappears in a classical metatheory, sets~$M$ as displayed are called
\emph{dense} (in~${\downarrow}\sigma$) in the literature on classical set-theoretic forcing, and
upward-closed downward-directed subsets of~$F$ which meet all dense sets are
called \emph{generic filters}, in line (but more restrictive) than our
terminology for arbitrary forcing notions.

If the poset~$L$ of forcing conditions is \emph{atomless} (that is, for every
condition~$\sigma \in L$ there are conditions~$\alpha,\beta \preccurlyeq \sigma$
without a common refinement), as in commonly the case in classical
set-theoretic forcing~\cite[Lemma~1.33]{schilhan:bsc}, then no such generic filter exists in~$V$.
In contrast, coarser covering systems on atomless posets may allow
filters to exist already in~$V$, as the examples above demonstrate.
\end{remark}

A forcing notion is not only a template for a forcing extension of the universe and
for a suitable formula translation, but also for a space in the sense of
pointfree topology. The forcing conditions constitute the basic opens of the
induced space while the covering system specifies generating coverings of
those opens. The points of this space are in canonical bijection with the
filters of the forcing notion.

For the purposes of forcing, the most important use case is when the forcing
notion is nontrivial but no filters exist in the base universe. In this case
the induced space is nontrivial and without points, highlighting that a
pointfree approach to topology is required to make sense of this space.

Conversely, every space in pointfree topology gives rise to a forcing notion such that its
filters are in canonical one-to-one correspondence with the points of the space.
For instance, let a space be given by a frame~$L$ as in locale
theory~\cite{picado-pultr:frames-and-locales}. Then a covering system is
defined by~$\Cov(\sigma) \defeq \{ M \in P(L) \,|\, \sigma = \bigvee M \}$.


\subsection{The eventually monad} Let~$L$ be a forcing notion. A
predicate~$P$ on~$L$ is called \emph{monotone} iff~$\tau \preccurlyeq \sigma$
implies~$P\sigma \Rightarrow P\tau$. Such predicates express positive
observations which are stable under refinement of approximations. For
instance, in the case of the forcing notion of Example~\ref{ex:notion-enum},
the proposition~$P\sigma$ could express that a particular element~$x_0 \in X$
is among the terms of~$\sigma$.

For a monotone predicate~$P$, we introduce a derived predicate denoted~``$P
\mid \sigma$'' (pronounced~``$P$ bars~$\sigma$'') expressing that no matter how an approximation~$\sigma$ evolves
to a better approximation~$\tau$, eventually~$P\tau$ will hold. Similar to
Coquand and Persson's approach to well quasi-orders~\cite[Definition~6]{coquand-persson:groebner} and
Coquand and Lombardi's approach to Noetherian
rings~\cite{coquand-lombardi:krull,coquand:invariant}, we define this predicate
in a direct inductive fashion, by the following generating clauses~(\flink{§4.§4-2.Definition-Ev}):
\begin{enumerate}
\item If~$P\sigma$, then~$P \mid \sigma$.
\item If~$P \mid \tau$ for all~$\tau \in R$, where~$R$ is some covering
of~$\sigma$, then~$P \mid \sigma$.
\end{enumerate}
Hence, to witness~$P \mid \sigma$, we may directly witness~$P\sigma$ or first
ask for a refinement of~$\sigma$ as envisaged by the covering
system.\footnote{The induction
principle~\cite{aczel-rathjen:notes,aczel-rathjen:cstdraft,rathjen:genind,aczel:ind} corresponding to the definition of the
bar predicate is this: For every predicate~$Q$ on~$L$, if
\begin{enumerate}
\item for every element~$\sigma \in L$, $P\sigma \Rightarrow Q\sigma$, and if
\item for every element~$\sigma \in L$ and every covering~$R \in \Cov(\sigma)$,
$(\forall \tau \in R\_ Q\tau) \Rightarrow Q\sigma$,
\end{enumerate}
then~$P\sigma \Rightarrow Q\sigma$ for every element~$\sigma \in L$.}

\begin{lemma}[\flink{§4.§4-2.Lemma-4-10}]The relaxation of~$P$ is again monotone, that is~$P \mid \sigma
\Rightarrow P \mid \tau$ if~$\tau \preccurlyeq \sigma$.\end{lemma}

\begin{proof}By induction on the given witness of~$P \mid \sigma$:
\begin{enumerate}
\item If~$P\sigma$, then also~$P\tau$ and hence~$P \mid \tau$ by
monotonicity of~$P$.
\item If~$P \mid \sigma'$ for all~$\sigma' \in R$, where~$R$ is a covering
of~$\sigma$, then by the stability condition
of Definition~\ref{defn:covering-system} there is a covering~$S \in \Cov(\tau)$
such that~$S \subseteq {\downarrow}R$. Hence for every element~$\tau' \in S$,
there is an element~$\sigma' \in R$ such that~$\tau' \preccurlyeq \sigma'$. By the
induction hypothesis, we have~$P \mid \tau'$ for all such elements~$\tau'$, and
hence~$P \mid \tau$. \qedhere
\end{enumerate}
\end{proof}

The functor mapping a predicate~$P$ to its induced
relaxation~$P\mid\cdot$ is a monad on the category of monotone predicates, dubbed the
\emph{eventually monad}. In computer science parlance, this monad is
the (parametrized) freer monad~\cite{kiselyov-ishii:freer,apfelmus:operational}
on~$\Cov$, that is the free monad~\cite[Section~6]{swierstra:carte}
on the free functor on~$\Cov$.
%
The following two basic results on ``escaping the monad'' shed light on the
meaning of~$P \mid \sigma$ and are crucial for the forcing extension and the
base universe to satisfy the same first-order statements.

\begin{proposition}[\flink{§4.§4-2.Proposition-4-11}]\label{prop:ev-points}Let~$L$ be a forcing notion. Let~$P$
be a monotone predicate on~$L$. If~$P \mid \sigma$, then every filter~$F$ which
contains~$\sigma$ also contains a refinement~$\tau \preccurlyeq \sigma$
with~$P\tau$.
\end{proposition}

\begin{proof}By induction on the given witness of~$P \mid \sigma$, as guided by
a given filter~$F$:
\begin{enumerate}
\item If~$P\sigma$, we conclude with setting~$\tau \defeq \sigma$.
\item If~$P \mid \tau$ for all~$\tau \in R$, where~$R$ is some covering
of~$\sigma$, then by the splitting property the filter~$F$ contains a refinement~$\tau_0
\preccurlyeq \sigma$ with~$\tau_0 \in R$. By the induction hypothesis, there is a
further refinement~$\tau \preccurlyeq \tau_0$ contained in~$F$ such that~$P\tau$.\qedhere
\end{enumerate}
\end{proof}

The converse of Proposition~\ref{prop:ev-points} can only hold in the case that
the formal space presented by the forcing notion has \emph{enough points}.
A case in which the converse emphatically fails is in the situation of
Example~\ref{ex:notion-enum} when the set~$X$ is uncountable, for in this case
there are no filters at all. Illuminating is also the case of forcing a
\emph{generic sequence}~$\NN \to \NN$ (which is just
Example~\ref{ex:notion-enum} in the special case~$X \defeq \NN$, but without
the second kind of covering): In this case the converse of
Proposition~\ref{prop:ev-points} is equivalent to the principle of monotonic
bar induction.

We think of~``$P \mid \sigma$'' as an inductive paraphrasing, not directly referring to
filters and indeed even being nontrivial in case there are no filters at all in the base
universe, of the statement that every filter containing~$\sigma$ also contains
a refinement~$\tau \preccurlyeq \sigma$ with~$P\tau$. While the latter statement
refers to filters---ideal, completed objects---the former has a more finitary
character.

\begin{lemma}[{\cite[Proposition~V.3.2]{joyal-tierney:grothendieck}}, \flink{§4.§4-2.Proposition-4-12}]\label{prop:cov-open}
Let~$L$ be a forcing notion such that every covering is inhabited. Let~$P$ be a
constant predicate on~$L$. Then~$P \mid \sigma$ implies~$P\sigma$.
\end{lemma}

\begin{proof}By induction. In computational terms, we inspect a given witness
of~$P \mid \sigma$ and descend into it, using the assumption that every
covering is inhabited in order to pick out branches.
\end{proof}

\begin{example}[\flink{§4.Example-4-13}]In the situation of Example~\ref{ex:notion-enum}, let the
set~$X$ be inhabited by an element~$x_0$. Then the criterion of
Proposition~\ref{prop:cov-open} is satisfied: Coverings of the first kind are
inhabited by~$\sigma x_0$ and coverings of the second kind are inhabited
by $\sigma a$. In computational terms, if a program in the eventually
monad asks for the current approximation~$\sigma$ to be more defined or to include a
specific element~$a$, we just append~$x_0$ respectively~$a$ to~$\sigma$.
\end{example}

\begin{example}In the situation of Example~\ref{ex:notion-negneg}, for every
monotone predicate~$P$ we have~$P \mid \star$ if and only if~$\neg\neg
(P\star)$. That is, the eventually monad coincides with the double negation or
continuation monad. In particular, we can generally escape from the monad only
in presence of the law of excluded middle.\end{example}

\begin{example}In the situation of Example~\ref{ex:notion-scott},
let~$\sigma_0 \in L$ be a fixed element. Let~$P\sigma
\vcentcolon\Leftrightarrow (\sigma_0 \leq \sigma)$. Then~$P \mid \sigma$ if
and only if~$\sigma_0 \sqsubseteq \sigma$ in the sense of the inductively
generated relation of~\cite[Definition~18]{wessel-schuster:radical}.\end{example}

It is prudent to introduce the quantifier-like notation~``$\nabla \sigma\_
P\sigma$'', pronounced ``eventually it is the case that~$P\sigma$ holds'',
for~$P \mid \sigma$. For instance, in the situation of
Example~\ref{ex:notion-enum}, we have
\[ \forall x \in X\_ \nabla \sigma\_ x \in \sigma
\qquad\text{(meaning $\forall x \in X\_ ((x \in \cdot) \mid \sigma)$),} \]
expressing that for every element~$x \in X$ it will eventually be the case that
it is enumerated; but typically we do not have
\[ \nabla \sigma\_ \forall x \in X\_ x \in \sigma
\qquad\text{(meaning $(\forall x \in X\_ x \in \cdot) \mid \sigma$),} \]
expressing that eventually it will be the case that all elements are
enumerated.

\begin{remark}The ``localization''~$P \mid \cdot$ of a monotone predicate~$P$
has a close connection to sheaf theory. A monotone
predicate~$P$ gives rise to a presheaf on the thin category induced from~$L$,
more precisely a subpresheaf of the terminal presheaf, by mapping an
element~$\sigma \in L$ to the truth value of~$P\sigma$. The presheaf
mapping~$\sigma$ to the truth value of~$P \mid \sigma$ is then the
sheafification with respect to the Grothendieck coverage induced from the
covering system attached to~$L$.\end{remark}


% fixed beforehand, part. substitute
% grow dynamically
% aim

% P|σ, translation
% (Rem.: additional nongeom. seq.)

% comp. content

% other forcing


\subsection{The translation}\label{sect:translation}

Let~$L$ be a forcing notion. The purpose of this section is to describe, purely
in terms of the base universe~$V$, when a bounded first-order statement holds
in the forcing extension~$V^\nabla$ generated by~$L$. We consider statements
over the (large) first-order signature~$\Sigma$ which has~(\flink{§4.§4-3.Definition-Language})
\begin{enumerate}
\item one sort~$\underline{X}$ for each set~$X$ in the base universe,
\item one~$n$-ary function symbol~$\underline{f} : \underline{X_1} \times
\cdots \times \underline{X_n} \to \underline{Y}$ for each map~$f : X_1 \times
\cdots \times X_n \to Y$,
\item one~$n$-ary relation symbol~$\underline{R} \hookrightarrow
\underline{X_1} \times \cdots \times \underline{X_n}$ for each relation~$R
\subseteq X_1 \times \cdots \times X_n$, and
\item an additional unary relation symbol~$G \hookrightarrow \underline{L}$ (to
be interpreted as the \emph{generic filter} of~$L$).
\end{enumerate}
As usual, substitution~$\varphi[\underline{x_0}/x]$ of a constant (nullary
function symbol) for a free variable and interpretation
brackets~$\llbracket\ldots\rrbracket$ are defined; for
instance~$\llbracket\underline{f}(\underline{x})\rrbracket = f(x)$.
Recursively in the structure of a formula~$\varphi$ over this signature, and
similar to Kripke or Beth semantics, we define what it means that~``$\varphi$
is forced by a condition~$\sigma \in L$'', symbolically denoted as~``$\sigma
\forces \varphi$''~(\flink{§4.§4-3.Definition-Semantics}):
\newcommand{\defeqv}{\quad\text{iff}\quad}
\begin{tabbing}
  \qquad \= $\sigma \forces \underline{R}(\underline{s_1},\ldots,\underline{s_n})$ \= \defeqv $s = t$. \= \kill

  \> $\sigma \forces s = t$
  \> \defeqv $\nabla \sigma\_ \llbracket s \rrbracket = \llbracket t \rrbracket$. \\[0.3em]

  \> $\sigma \forces \underline{R}(s_1,\ldots,s_n)$
  \> \defeqv $\nabla\sigma\_ R(\llbracket s_1 \rrbracket,\ldots,\llbracket s_n \rrbracket)$. \\[0.3em]

  \> $\sigma \forces G\tau$
  \> \defeqv $\nabla\sigma\_ \sigma \preccurlyeq \llbracket\tau\rrbracket$. \\[0.3em]

  \> $\sigma \forces \varphi \Rightarrow \psi$
  \> \defeqv $\forall \tau \preccurlyeq \sigma\_ (\tau \forces \varphi) \Rightarrow
  (\tau \forces \psi)$. \\[0.3em]

  \> $\sigma \forces \top$ \> \defeqv $\top$. \\[0.3em]

  \> $\sigma \forces \varphi \wedge \psi$
  \> \defeqv $(\sigma \forces \varphi) \wedge (\sigma \forces \psi)$. \\[0.3em]

  \> $\sigma \forces \forall x\?\underline{X}\_ \varphi$
  \> \defeqv $\forall \tau \preccurlyeq \sigma\_ \forall x_0 \in X\_ \tau \forces
  \varphi[\underline{x_0}/x]$. \\[0.3em]

  \> $\sigma \forces \bot$ \> \defeqv $\nabla\sigma\_ \bot$ \\[0.3em]

  \> $\sigma \forces \varphi \vee \psi$
  \> \defeqv $\nabla\sigma\_ (\sigma \forces \varphi) \vee (\sigma \forces \psi)$. \\[0.3em]

  \> $\sigma \forces \exists x\?\underline{X}\_ \varphi$
  \> \defeqv $\nabla\sigma\_ \exists x_0 \in X\_ \sigma \forces \varphi[\underline{x_0}/x]$.
\end{tabbing}
Finally, when we say that some first-order statement~$\varphi$ ``holds in the
forcing extension~$V^\nabla$'', we mean
\[ \forall \sigma\_ \sigma \forces \varphi,
\quad\text{symbolically also written as: $\varphi^\nabla$.} \]
In this way, every statement about the forcing extension is actually a
statement about the base universe~$V$. Because of the well-established nature
of the eventually monad, these statements have clear computational content;
which content exactly, depends on the forcing condition.

In effect, these definitions describe a formula translation~$\varphi \mapsto
\varphi^\nabla$ akin to the double negation translation---more precisely, the
variant called \emph{Gödel--Gentzen translation} in~\cite{ferreira-oliva:translation2,ferreira-oliva:translation}.
There are two differences to this revered translation: Firstly, in place
of~$\neg\neg$, a different \emph{modality} (\emph{local operator},
see~\cite[Section~14.5]{goldblatt:topoi},~\cite{goldblatt:modality},~\cite{pfenning-davies:reconstruction})
is used, namely the eventually monad~$\nabla$ induced from the forcing
notion~$L$, as in the~``$J$-'' or~``$T$-translation''~\cite{aczel:russell-prawitz,escardo-oliva:peirce-shift}.
Secondly, this modality depends on a parameter, the current forcing
condition~$\sigma$. In the case of the forcing notion of
Example~\ref{ex:notion-negneg}, the translation described here indeed
specializes to precisely the double negation translation.
% XXX: cite Chuangjie!

\begin{lemma}[\flink{§4.§4-3.Lemma-4-17}]\label{lemma:kj-basics}For every first-order formula~$\varphi$,
the interpretation is \ldots
\begin{enumerate}
\item[(a)] monotone: If~$\sigma \forces \varphi$ and if~$\tau \preccurlyeq \varphi$,
then also~$\tau \forces \varphi$.
\item[(b)] local: If~$\nabla\sigma\_ \sigma \forces \varphi$,
then~$\sigma \forces \varphi$.
\end{enumerate}
\end{lemma}

\begin{proof}Routine induction on the structure of the formula~$\varphi$; see,
for instance,~\cite[p.~98]{streicher:ctcl}. The fundamental properties of the eventually
monad~$\nabla$ required for the verification are the ``nucleus
axioms'' (``local operator
axioms''~\cite[Section~14.5]{goldblatt:topoi},~\cite{goldblatt:modality}):
\begin{enumerate}
\item $P\sigma \Rightarrow (\nabla\sigma\_P\sigma)$
\item $(\nabla\sigma\_\nabla\sigma\_P\sigma) \Rightarrow
(\nabla\sigma\_P\sigma)$
\item $(\nabla\sigma\_P\sigma\wedge Q\sigma) \Leftrightarrow
(\nabla\sigma\_P\sigma) \wedge (\nabla\sigma\_Q\sigma)$ \qedhere
\end{enumerate}
\end{proof}

\begin{theorem}\label{thm:kj-sound}The interpretation is sound with respect to
intuitionistic first-order logic: If a formula~$\varphi$ is intuitionistically
provable, then~$\varphi$ holds in~$V^\nabla$.\end{theorem}

\begin{proof}Routine induction on the structure of intuitionistic derivations,
see~\cite[Sections~6.7,~6.8]{borceux:handbook3}. For instance, in view of the
rule
\[
  \infer{\varphi \vee \psi \seq{\vec x} \chi}{\varphi \seq{\vec x} \chi \quad
  \psi \seq{\vec x} \chi}
\]
of intuitionistic sequent calculus we need to verify that
\[
  \text{if
  $\sigma \forces \forall \vec x\?\vec X\_ (\varphi \Rightarrow \chi)$ and if
  $\sigma \forces \forall \vec x\?\vec X\_ (\psi \Rightarrow \chi)$, then
  $\sigma \forces \forall \vec x\?\vec X\_ (\varphi \vee \psi \Rightarrow \chi)$;
  }
\]
this particular verification rests on Lemma~\ref{lemma:kj-basics}(b).
\end{proof}

It is by Theorem~\ref{thm:kj-sound} that we may ``reason in the forcing
extension'': If we have established that some statement~$\alpha$ holds
in~$V^\nabla$ (for instance, by direct verification of the translated
statement~$\alpha^\nabla$) and if we have an intuitionistic proof that~$\alpha$
entails some further statement~$\beta$, then we may conclude that~$\beta$ holds
in~$V^\nabla$. Just as proofs give rise to programs, translated proofs give
rise to programs ``with side effects in the eventually monad''.

As an actual construction of~$V^\nabla$ (as the category of sheaves over the
Grothendieck site induced from the forcing notion) is avoided and it is only
explained what it means for a statement to hold in~$V^\nabla$, our approach is
related to the naturalist account of forcing in classical set
theory~\cite[Theorem~2]{hamkins:multiverse},~\cite[Section~4]{maddy-meadows:reconstruction},~\cite{barton:forcing}.
Both the translation itself as well as Lemma~\ref{lemma:kj-basics} and
Theorem~\ref{thm:kj-sound} can be extended to the higher-order
setting~\cite[Section~D4.1]{johnstone:elephant}, making it possible to work in the forcing extension much in
the same way as in the base universe.

\begin{proposition}The forcing extension~$V^\nabla$ contains a filter
of~$\underline{L}$, namely~$G$, in the precise sense that the following
statements hold in~$V^\nabla$:
\begin{enumerate}
\item[(1)] $\forall \sigma \? \underline{L}\_ \forall \tau \? \underline{L}\_
\bigl(\tau \mathrel{\underline{\preccurlyeq}} \sigma \wedge G\tau\bigr)
\Rightarrow G\sigma$.
\item[(2a)] $\exists \sigma \? \underline{L}\_ G\sigma$.
\item[(2b)] $\forall \alpha \? \underline{L}\_
\forall \beta \? \underline{L}\_
(G\alpha \wedge G\beta) \Rightarrow
\exists \sigma \? \underline{L}\_
\sigma \mathrel{\underline{\preccurlyeq}} \alpha \wedge
\sigma \mathrel{\underline{\preccurlyeq}} \beta \wedge
G\sigma$.
\item[(3)] $\forall \sigma \? \underline{L}\_
\forall R \? \underline{P(L)}\_
\bigl(R \mathrel{\underline{\in}} \underline{\Cov}(\sigma) \wedge
G\sigma\bigr) \Rightarrow
\exists \tau \? \underline{L}\_
G\tau \wedge \tau \mathrel{\underline{\in}} R$.
\end{enumerate}
\end{proposition}

\begin{proof}Straightforward verification.
\end{proof}

\begin{example}\label{ex:gen-enum-max}For the forcing notion of Example~\ref{ex:notion-enum}, the
forcing extension contains an enumeration~$f$ of~$\underline{X}$ in the following
sense: Defining~``$f(n) = x$'' to be an abbreviation for~``$\exists
\sigma\?\underline{L}\_ G\sigma \wedge \sigma\underline{[}n\underline{]} =
x$'', in the forcing extension we have that
\begin{enumerate}
\item ``$f$ is everywhere-defined'': $\forall n\?\underline{\NN}\_ \exists
x\?\underline{X}\_ f(n) = x$,
\item ``$f$ is single-valued'': $\forall n\?\underline{\NN}\_ \forall
x\?\underline{X}\_ \forall y\?\underline{X}\_
(f(n) = x \wedge f(n) = y) \Rightarrow x = y$, and
\item ``$f$ is surjective'': $\forall x\?\underline{X}\_ \exists n\?\underline{\NN}\_
f(n) = x$.
\end{enumerate}
In case~$X$ carries a ring structure, we can further define~``$x \in \mmm$''
to be an abbreviation for~``$\exists n\?\underline{\NN}\_ (f(n) = x \wedge x \in
\mmm_{n+1})$'', where~$\mmm_{n+1}$ morally refers to the ideal constructed in
Section~\ref{sect:constr} applied to the generic enumeration~$f$, but which
formally has to be read along the lines of Lemma~\ref{lemma:uniform-char}(b).
In the forcing extension, we then have that
\begin{enumerate}
\addtocounter{enumi}{3}
\item ``$\mmm$ is an ideal'':

-- ``$\mmm$ contains the zero element'': $\underline{0} \in \mmm$ \\
-- ``$\mmm$ is closed under addition'': $\forall x\?\underline{A}\_ \forall y\?\underline{A}\_ (x \in \mmm \wedge y \in
\mmm) \Rightarrow x\mathop{\underline{+}}y \in \mmm$ \\
-- ``$\mmm$ has the magnet property'': $\forall x\?\underline{A}\_ \forall
r\?\underline{A}\_ x \in \mmm \Rightarrow rx \in \mmm$

\item ``$\mmm$ is maximal in the weak sense'':

-- ``$\mmm$ is proper'': $\underline{1} \in \mmm \Rightarrow \underline{1} =
\underline{0}$ \\
-- $\forall x\?\underline{A}\_ \bigl((\exists u\?\underline{A}\_
\exists v\?\underline{A}\_ \underline{1} = u \mathop{\underline{+}} vx \wedge u
\in \mmm) \Rightarrow \underline{1} =
\underline{0}\bigr) \Rightarrow x \in \mmm$
\end{enumerate}
\end{example}

\begin{example}\label{ex:gen-max}For the forcing notion of Example~\ref{ex:notion-max}, the
forcing extension contains a strong maximal ideal~$\nnn$ of~$\underline{A}$ in the following
sense: Defining~``$x \in \nnn$'' to be an abbreviation for~``$\exists
\aaa\?\underline{L}\_ G\aaa \wedge x \mathrel{\underline{\in}} \aaa$'',
in the forcing extension we have that
\begin{enumerate}
\item ``$\nnn$ is an ideal'' as in Example~\ref{ex:gen-enum-max}(4), and
\item ``$\nnn$ is maximal in the strong sense'':

-- ``$\nnn$ is proper'': $\underline{1} \in \nnn \Rightarrow \underline{1} =
\underline{0}$ \\
-- $\forall x\?\underline{A}\_ x \in \nnn \vee (\exists u\?\underline{A}\_
\exists v\?\underline{A}\_ \underline{1} = u \mathop{\underline{+}} vx \wedge u
\in \nnn)$
\end{enumerate}
\end{example}

\begin{theorem}[\flink{§4.§4-3.Theorem-4-22}]\label{thm:backforth}Assume that~$L$ is inhabited and that every
covering is inhabited. Let~$\varphi$ be a first-order formula not containing
the unary relation symbol~$G$. Then the following statements are equivalent:
\begin{enumerate}
\item[(a)] $\varphi$ holds in~$V$.
\item[(b)] $\varphi$ holds in~$V^\nabla$.
\end{enumerate}
\end{theorem}

\begin{proof}Routine induction on the structure of~$\varphi$ employing Lemma~\ref{prop:cov-open}.
\end{proof}

Both directions of Theorem~\ref{thm:backforth} are central for putting the
forcing extension to good use. By the direction~``(a)~$\Rightarrow$~(b)'',
we may retain everything already known about the base universe when passing to
the forcing extension---as long as the facts we would like to import can be
phrased as first-order formulas. In the other direction, every result obtained
in the forcing extension descends to the base universe---as long as the result
can be phrased as a first-order formula and does not mention the generic
filter. For classical set-theoretic forcing, this strategy is commented on for
instance in~\cite[Theorem~2]{hamkins:multiverse}.

The assumption of Theorem~\ref{thm:backforth} on~$L$ is for instance satisfied
for the forcing notion of Example~\ref{ex:notion-enum}. However, it fails for
the forcing notion of Example~\ref{ex:notion-max}. A variant of
Theorem~\ref{thm:backforth} can do without the requirement that all coverings
are inhabited, at the expense of a restricted scope on the interpreted
formulas:

\begin{theorem}[\flink{§4.§4-3.Theorem-4-23}]\label{thm:backforth-weak}Assume that~$L$ contains a top
element~$1$, and that all iterated coverings of the top element are inhabited (so
that~$P \mid 1$ implies~$P$ for constant predicates~$P$).
Let~$\varphi$ be a coherent implication (a first-order formula of the
form~$\forall\ldots\forall\_(\ldots\Rightarrow\ldots)$, where antecedent and
succedent do not contain~``$\forall$'' and~``${\Rightarrow}$'') not containing
the unary relation symbol~$G$. Then the following statements are equivalent:
\begin{enumerate}
\item[(a)] $\varphi$ holds in~$V$.
\item[(b)] $\varphi$ holds in~$V^\nabla$.
\end{enumerate}
\end{theorem}

\begin{proof}Omitted. In the language of toposes, the assumption on~$L$ ensures
that the canonical geometric morphism~$V^\nabla \to V$ is surjective.
Pullback along surjective morphisms preserves and reflects the interpretation
of coherent implications.
\end{proof}


\subsection{The connection to dynamical algebra}
\label{sect:dynalg}

Having provided the required background on constructive forcing in
Sections~\ref{sect:forcing-notions}--\ref{sect:translation}, we are now in the
position to harvest the fruits of this machinery. Let~$A$ be an arbitrary ring,
not presumed to be countable. Let~$P$ be an informal argument about~$A$ making
use of a maximal ideal of~$A$. Under which circumstances can we provide a constructive
reading of~$P$?

``If the considered proof is sufficiently uniform (experience shows that it is
always the case), the computation obtained as a whole is finite and ends in the
desired conclusion'', explain Lombardi and Quitté the scope of the
dynamical algebra toolbox for this kind of situation~\cite[Section~XV.6,
p.~876]{lombardi-quitte:constructive-algebra}. Using the notion of forcing
extensions, we can provide a formal rendition of this important informal
insight.

Let~$\Sigma'$ be the signature~$\Sigma$ of Section~\ref{sect:translation}, but
without the unary relation symbol~$G$ and instead with an unary relation
symbol~$M \hookrightarrow \underline{A}$ (to be used as a stand-in for a
maximal ideal).

\begin{theorem}\label{thm:dynalg-formal}Let~$P$ be a proof
\begin{itemize}
\item formulated in intuitionistic (perhaps higher-order) logic
\item over the signature~$\Sigma'$
\item of a first-order claim not referring to~$M$
\item making use of the weak maximal ideal condition of Example~\ref{ex:gen-enum-max}(4,5)
\end{itemize}
Then the claim asserted by~$P$ holds in~$V$.
\end{theorem}

\begin{proof}Let~$V^\nabla$ be the forcing extension generated
from the forcing notion of Example~\ref{ex:notion-enum}, so that~$V^\nabla$
contains the generic enumeration of the elements of~$A$. Since~$A$ is countable
in~$V^\nabla$, the iterative maximal ideal construction of
Section~\ref{sect:constr} applies there, resulting in a maximal ideal~$\mmm$ of~$A$
(or more precisely,~$\underline{A}$) in~$V^\nabla$~(\flink{§4.§4-4}). Interpreting~$P$
in~$V^\nabla$, with the unary relation symbol~$M$ interpreted as membership
in~$\mmm$, we conclude that the proven claim holds in~$V^\nabla$. By
Theorem~\ref{thm:backforth}, it also holds in~$V$.\end{proof}

The central workhorse of the dynamical algebra approach to maximal
ideals is systematic folding of branches obtained by case distinctions along
the maximal ideal condition, propagating information from leaves
to the root, as reviewed on
page~\pageref{page:dynalg-folding} or in more detail
in~\cite[Section~XV.6]{lombardi-quitte:constructive-algebra}.
We regard the maximal ideal~$\mmm$ constructed in the proof of
Theorem~\ref{thm:dynalg-formal} as a \emph{reification} of the dynamical algebra
toolbox to maximal ideals---while the latter is a heuristic explanation
how to reread proofs involving maximal ideals, the former is an actual maximal
ideal (living in a forcing extension). Unwinding all definitions, the central
idea of the dynamical approach is recovered as the computational content of the
proof of Lemma~\ref{lemma:omnibus}(b).

For instance, Theorem~\ref{thm:dynalg-formal} can be followed in order to generalize
the test case analyzed in Proposition~\ref{prop:surj-matrix} from countable
rings to arbitrary rings. We formalized this approach in
Agda~(\flink{§4.TestCase}); unwinding the forcing machinery,
we roughly obtain the following proof:
\begin{quotation}\small\label{proof:surj-matrix-explicit}
\textbf{Proof.} We show, by induction on the number of rows and the number of
formal zero entries: For every matrix~$M$ over a ring~$A$, if~$M$ has more rows
than columns and if the induced linear map~$A^m \to A^n$ is surjective, then~$1
= 0$ in~$A$.

Let a matrix~$M$ with more rows than columns over a ring~$A$ be given. If all
entries of~$M$ are known to be zero (formal zeros), then~$1 = 0$ in~$A$ because
the vector~$(1,0,\ldots,0)$ still belongs to the range of~$M = 0$.

Else let~$a_{ij}$ be the first entry not known to be zero. It becomes a formal
zero over the quotient ring~$A/(a_{ij})$. Since the matrix~$M$ is still
surjective over the quotient, the induction hypothesis (applied to the quotient
ring) implies~$1 = 0$ in~$A/(a_{ij})$. Hence~$a_{ij}$ is invertible in~$A$.

By elementary row and column operations, the matrix can be transformed to a
matrix of the form~$\left(\begin{smallmatrix}1 & 0 \\ 0 &
M'\end{smallmatrix}\right)$, where the induced linear map of the submatrix~$M'$ is again
surjective. Hence~$1 = 0$ by the induction hypothesis (applied to~$A$).
\end{quotation}
Notably, this unrolled proof is not the same as the determinant-based proofs of
Richman~\cite[Theorem~1]{richman:trivial-rings} or
Lombardi--Quitté~\cite[Proposition~II-5.2]{lombardi-quitte:constructive-algebra}.
Instead, it is more in spirit of the proofs
of~\cite[Theorems~2--4]{richman:trivial-rings} or
of~\cite{blechschmidt:generic-freeness}, but using auxiliary computations over
quotient rings instead of localized rings. This feature is to be
expected---localized rings typically appear when unwinding proofs which make
use of the generic localization~\cite[Section~3]{blechschmidt:generalized-spaces}
as opposed to proofs making use of the iterative maximal ideal construction
applied to generic enumeration.

Theorem~\ref{thm:dynalg-formal} is not the only way to reify the dynamical
approach to maximal ideals. Instead of employing the forcing extension
containing the generic enumeration, we can also employ the forcing extension
of Example~\ref{ex:notion-max} containing a generic maximal ideal in the strong
sense. Since for this alternative forcing notion the assumption for going back and
forth---Theorem~\ref{thm:backforth}---is not satisfied, its scope is
restricted:

\begin{theorem}\label{thm:dynalg-formal-strong}Let~$P$ be a proof
\begin{itemize}
\item formulated in intuitionistic (perhaps higher-order) logic
\item over the signature~$\Sigma'$
\item of a first-order claim not referring to~$M$ which moreover is a coherent implication
\item making use of the strong maximal ideal condition of
Example~\ref{ex:gen-max}.
\end{itemize}
Then the claim asserted by~$P$ holds in~$V$.
\end{theorem}

\begin{proof}The claim holds in the forcing extension generated by the forcing
notion of Example~\ref{ex:notion-max}, with the predicate~$M$ interpreted as
described in Example~\ref{ex:gen-max}, and passes down to~$V$ by
Theorem~\ref{thm:backforth-weak}.\end{proof}

%In this case the central workhorse of the dynamical approach is recovered by
%xxx.

The restriction in Theorem~\ref{thm:dynalg-formal-strong} to coherent
implications is reminiscient of the same kind of restriction in Barr's theorem on
transforming classical proofs to intuitionistic proofs. Indeed, while the
forcing extension generated by Example~\ref{ex:notion-max} does not yet satisfy
the full law of excluded middle, it does have a certain amount of classicality
built into it---its maximal ideal satisfies the strong maximal ideal condition.

The ideal~$\mmm$ obtained by applying the construction of Section~\ref{sect:constr} to
the generic enumeration of~$A$ and the ideal~$\nnn$ obtained by directly forcing a
strong maximal ideal serve similar purposes. Because they live in different universes,
it is not meaningful to ask whether they are equal. However, we may ask whether
they satisfy the same first-order statements. They do not:

\begin{proposition}\label{prop:mmm-nnn}With the terminology of
Proposition~\ref{prop:jac}, Example~\ref{ex:gen-enum-max} and
Example~\ref{ex:gen-max}, an element~$x \in A$ is \ldots \begin{enumerate}
\item[(a)] contained in the Jacobson radical if and only if~$x
\mathrel{\underline{\in}} \nnn$ holds in the forcing extension containing the
generic maximal ideal.
\item[(b)] not apart from the Jacobson radical if and only if~$x
\mathrel{\underline{\in}} \mmm$ holds in the forcing extension containing the
generic enumeration.
\end{enumerate}
\end{proposition}

\begin{proof}The first statement has been analyzed before, in the language of
entailment relations~\cite[Corollary~2]{schuster-wessel:krull}. One proves by
induction that if~$\nabla\aaa\_ x \in \aaa$, then~$x \in \mathrm{Jac}(\aaa)$.

For the ``only if'' direction of the second claim, arguing in the forcing extension,
we assume (as we may) for the sake of contradiction that~$1 \in \mmm + (x)$.
Then there is an element~$y \in A$ such that~$1 - xy$ is an element of~$\mmm$ and
hence is not invertible. This is a contradiction to~$x$ not being apart from
the Jacobson radical.

For the ``if'' direction, let~$u \in A$ be arbitrary and assume that~$1 -
ux$ is not invertible. Then~$[1-ux] \models 1-ux \in \mmm$. By assumption,~$[\,]
\models x \in \mmm$ and hence also~$[1-ux] \models x \in \mmm$. Thus~$[1-ux]
\models 1 \in \mmm$, a contradiction.
\end{proof}

\begin{remark}\label{remark:minimal-prime-ideals}In addition to maximal ideals, minimal prime ideals are important
ingredients for some reduction techniques in classical commutative algebra. For
instance, the stalk of a reduced ring at a minimal prime ideal enjoys the good
property of being a field. Can the iterative construction of Section~\ref{sect:constr} be adapted to
build a minimal prime ideal, or (equivalently in classical mathematics) a maximal prime
filter (a saturated multiplicative subset such that~$x + y \in \ppp$
implies~$x \in \ppp \vee y \in \ppp$ and such that~$0 \in \ppp \Rightarrow 1 = 0$)?

Given any sequence~$\ppp_0,\ppp_1,\ldots$ of prime filters of~$A$, we can indeed
explicitly construct a prime filter~$\qqq$ which is maximal among the given
prime filters, that is which satisfies~$\qqq \subseteq \ppp_n \Rightarrow \qqq
= \ppp_n$, as follows:
\begin{align*}
  \qqq &\defeq \bigcup\,\Bigl(\bigcup_n S_n\Bigr), \\
  &\quad\text{where}\quad S_{0\phantom{{}+n}} \defeq \emptyset, \\
  &\quad\phantom{\text{where}\quad} S_{n+1} \defeq S_n \cup \{ \ppp_n \,|\,
  \text{$S_n \cup \{\ppp_n\}$ is a chain} \}
\end{align*}
(A \emph{chain} is a subset such that for any two elements~$\ppp$ and~$\ppp'$,
$\ppp \subseteq \ppp'$ or~$\ppp' \subseteq \ppp$.) As the set~$P$ of all prime
filters of~$A$ might not be countable, it is tempting to apply this
construction to the \emph{generic enumeration} of all prime filters of~$A$,
in the forcing extension where~$P$ is forced to be countable. However,
while the passage from the base universe to the forcing extension preserves and
reflects first-order logic, the two universes typically differ in their stock
of subsets: In the forcing extension, the ring~$A$ can catch new prime filters
which did not exist in the base universe; the prime filter~$\qqq$ will only be
maximal with respect to the old prime filters.

That said, if we relax the primality condition in a classically equivalent way, a
different iterative procedure can be used to construct a maximal prime filter;
see Example~\ref{ex:inc-ring2} below. With this construction, we can aspire to
decrypt classical proofs in commutative algebra employing minimal prime ideals.
Indeed, in this way we reify the dynamical approach to minimal prime
ideals~\cite[Section~XV.7]{lombardi-quitte:constructive-algebra}.
For instance, the classical proofs of the analog of
Proposition~\ref{prop:surj-matrix} for injective linear maps and of McCoy's
theorem (for every injective linear map~$A^m \to A^n$, the ideal of
its~$m$-minors is regular) reproduced
in~\cite[Section~3.5]{blechschmidt:generalized-spaces} can be interpreted in
this framework. Unwinding the resulting constructive proof for the analog of
Proposition~\ref{prop:surj-matrix}, we recover Richman's
proof~\cite[Theorem~2]{richman:trivial-rings}; unwinding the resulting
constructive proof of McCoy's theorem, we recover the proof reproduced
at~\cite[p.~174]{blechschmidt:generalized-spaces} (but not the Cramer-style
proofs of~\cite{blocki:mccoy},
\cite[Theorem~5.22]{lombardi-quitte:constructive-algebra} or
\cite[Exercise~5.23A(3)]{lam:exercises}).

A substantially different approach to constructivizing minimal prime ideals,
directly forcing the existence of the generic maximal prime filter instead of
iteratively constructing one after forcing the existence of the generic
enumeration, has been explored by Coquand and
Lombardi~\cite[Section~6]{coquand-lombardi:logical}.
\end{remark}


\subsection{Further connections}

\paragraph{Noetherian conditions} Over the last 30 years, there has been a
gradual evolution of Noetherian conditions in the constructive algebra
community. Building on early pioneering work of
Tennenbaum~\cite{tennenbaum:hilbert}, Richman and Seidenberg proposed the
ascending chain condition, referring to ascending sequences of finitely
generated ideals~\cite{richman:noetherian-old,seidenberg:noether}. There is a
variant of Hilbert's basis theorem for this flavor of Noetherian rings;
however, its utility is limited because constructively, such ascending
sequences can be rare---for a particularly sequence-poor ring,
see~\cite[Example~2]{blass:induction}.
%
The ascending tree condition~\cite{richman:noetherian} is an attempt to fix
this deficiency; knowing that a ring satisfies this stronger condition gives much more
information than the ascending chain condition, and a version of Hilbert's
basis theorem shows that there is still an ample supply of important rings
satisfying this condition. There is a further condition which in many cases
of interest is even stronger, a wellfoundedness condition attributed to
Martin-Löf~\cite{jacobsson-lofwall:standard}.

Common to all these conditions is that for their corresponding version of
Hilbert's basis theorem, membership in finitely generated ideals needs to be
decidable, the ring needs to be coherent, or both. Is there a Noetherian flavor
which does not require either of these assumptions?

There is; the inductive condition used by Coquand, Lombardi and
Persson~\cite{coquand-persson:groebner,coquand-lombardi:krull} fits the bill.
Appreciating the obstacles which the proofs of Hilbert's basis theorem for the
earlier flavors of Noetherianity had to overcome, the clean proof~\cite[Corollary~16]{coquand-persson:groebner} for the
inductive condition has an almost magical
quality to it.

Forcing technology allows us to recognize that with this condition, we have
actually come full circle---back to the venerable ascending chain condition:

\begin{theorem}A ring is inductively
Noetherian~\cite{coquand-persson:groebner,coquand-lombardi:krull,coquand:invariant} if and only if a very
particular ascending sequence of finitely generated ideals stalls, namely
\emph{the generic one}.
\end{theorem}

\begin{proof}See the forthcoming
paper~\cite{blechschmidt-oldenziel:multiverse}.\end{proof}


\paragraph{The mystery of nongeometric sequents} Every forcing extension is
specifically tailored to support a generic filter of the corresponding forcing
notion. Hence it may come as a surprise that, despite not being designed in that way,
generic filters tend to have more, and indeed rather peculiar, properties
than would be expected just by virtue of being a filter. For instance:
\begin{enumerate}
\item The generic surjection~$f$ is not only everywhere-defined,
single-valued and surjective as expected, but also has the property that it is
\emph{not~not} the case that every desired finite pattern occurs among its
values: In the forcing extension it holds that for every finite list~$\sigma =
x_1 \ldots x_k$, it is \emph{not~not} the case that there is a number~$n \in
\mathbb{N}$ such that the values~$f(n), f(n+1), \ldots, f(n+k)$ agree
with~$\sigma$.

\item Localizing a ring at its \emph{generic prime filter} not only
yields a local ring, as expected when localizing at a prime filter, but in fact
a ring which is almost a field in the sense that nonunits are nilpotent.

\item The \emph{generic ideal} of a given ring is not only an ideal as
expected, but also maximal in the sense that nonzero elements of the quotient
are already invertible. As far as we know, this observation has not yet been
explored at all.
\end{enumerate}

This phenomenon is the \emph{mystery of nongeometric sequents}. The
survey~\cite[Section~3]{blechschmidt:generalized-spaces} presents a range of
applications of these unexpected properties, while the
paper~\cite{blechschmidt:nullstellensatz} attempts to explain their origin.

% xxx: Mention Löwenheim--Skolem.

% xxx: conservativity

% xxx: state monad


\section{Generalization to abstract inconsistency predicates on well-orders}
\label{sect:inc-wf}

This section generalizes the construction of Section~\ref{sect:constr} from
countable rings to arbitrary countable sets equipped with an abstract
\emph{inconsistency predicate} on their powerset. Abstract inconsistency
predicates are a common generalization of predicates such as ``the given ideal is
improper'', ``the given set of vectors is linearly dependent'' and ``the given
set of first-order formulas is inconsistent''; they help to present the
central aspects of the construction of Section~\ref{sect:constr} more tidily.
In a second step, we relax the countability assumption to a more general
well-foundedness requirement.


\subsection{Abstract inconsistency predicates}

The notion of inconsistency predicates can be defined in the quite general
context of directed-complete lattices as monotone predicates which split
directed joins~\cite{schuster-wessel:jacincpred}. For our purposes, the level of generality displayed in the
following definition is sufficient.

\begin{definition}Let~$X$ be a set. An \emph{inconsistency predicate} on the
powerset~$P(X)$ is a predicate~$\Incbare$ on~$P(X)$ which
\begin{enumerate}
\item is monotone: if~$U \subseteq V$ and~$\Inc{U}$, then~$\Inc{V}$, and
\item splits directed joins: if~$\mathcal{U} \subseteq P(X)$ is a directed subset
and~$\Inc{\bigl(\bigcup \mathcal{U}\bigr)}$, then~$\Inc{V}$ for some~$V \in \mathcal{U}$.
\end{enumerate}
\end{definition}

An important example of a directed join is the union of an ascending sequence
of subsets: For an inconsistency predicate~$\Incbare$, if~$\mathrm{Inc}{\bigl(\bigcup_{n \in \NN}
U_n\bigr)}$, then there is a number~$n$ such that~$\Inc{U_n}$. However, we will also
employ directed subsets of the form~$\{ U \} \cup \{ X \,|\, \varphi \}$
where~$\varphi$ is a proposition which might not be
decidable.\footnote{Directed subsets of this kind, classically trivial but
constructively relevant, have also played a role
in~\cite[Lemma~1]{schuster-wessel:jacincpred}
and~\cite[Example~I.1.7(2)]{moerdijk-vermeulen:proper-maps}.}

\begin{example}\label{ex:inc-ring}Let~$A$ be a ring. For any subset~$M \subseteq A$, let~$\Inc{M}$
state that~$1 \in (M)$, where~$(M)$ is the ideal generated by~$M$. Then~$\Incbare$ is an
inconsistency predicate.\end{example}

\begin{example}\label{ex:inc-ring2}Let~$A$ be a ring. For any subset~$M
\subseteq A$, let~$\Inc{M}$ state that the multiplicative set generated
by~$M$ contains~$0$, that is that some product~$m_1 \ldots m_n$ of elements
of~$M$ (with repetitions allowed) is zero. Then~$\Incbare$ is an inconsistency
predicate.\end{example}

\begin{example}\label{ex:inc-module}Let~$M$ be a module over a ring. For any subset~$U \subseteq M$,
let~$\Inc{U}$ denote that~$(U) = M$, where~$(U)$ is the submodule generated
by~$U$. Then~$\Incbare$ is an inconsistency predicate if and
only if~$M$ is finitely generated.\end{example}

\begin{example}\label{ex:inc-formulas}Let~$X$ be the set of sentences over some first-order
signature. Let~$\alpha \in X$ be a fixed sentence. Let~$\Inc{M}$ state that~$M$
entails~$\alpha$ in (minimal, intuitionistic or classical) first-order logic. Then~$\Incbare$ is an inconsistency
predicate.\end{example}

\begin{remark}The inconsistency predicates of
Examples~\ref{ex:inc-ring},~\ref{ex:inc-module} and~\ref{ex:inc-formulas} are
all induced by \emph{algebraic closure operators} as reviewed
in~\cite[Example~1]{wessel-schuster:radical}.\end{remark}


\subsection{Maximal consistent extensions}

For countable sets equipped with an inconsistency predicate, we have the
following generalization of the construction in Section~\ref{sect:constr}.

\begin{construction}\label{constr:inc}Let~$X$ be a countable set equipped with
an inconsistency predicate~$\Incbare$. Let~$x_0,x_1,\ldots$ be an enumeration of~$X$.
Let~$A_0 \subseteq X$ be an arbitrary subset. Let~``$\neg\varphi$''
mean~``$\varphi \Rightarrow \Inc{A_0}$''. Without appealing to any form of choice,
we recursively define
\[ A_{n+1} \defeq A_n \cup \bigl\{ x_n \,|\, \neg \Inc{(A_n\cup\{x_n\})} \bigr\} \]
and set~$A \defeq \bigcup_{n \in \NN} A_n$.
\end{construction}

\begin{lemma}\label{lemma:omnibus-inc}(In the situation of
Construction~\ref{constr:inc}.)
\begin{enumerate}
\item[(a)] The set~$A$ is equiconsistent with~$A_0$: If~$\Inc{A}$, then also~$\Inc{A_0}$.
\item[(b)] For every number~$n$, the following are equivalent: \\
(1) $x_n \in A_{n+1}$. \quad
(2) $x_n \in A$. \quad
(3) $\neg \Inc{(A\cup\{x_n\})}$. \quad
(4) $\neg \Inc{(A_n \cup \{x_n\})}$.
\end{enumerate}\end{lemma}

\begin{proof}For claim~(a), we verify by induction on~$n \in \NN$ that~$\neg
\Inc{A_n}$. The result then follows because~$\Incbare$ splits the directed join~$\bigcup_n A_n$.

The case~$n = 0$ is trivial. For the induction step~$n \to n+1$,
assume~$\Inc{A_{n+1}}$. Since~$A_{n+1} \subseteq A_n \cup \{x_n\}$, we
have~$\Inc{(A_n \cup \{ x_n \})}$ by monotonicity. Hence~$A_{n+1} = A_n \cup \{ x_n \,|\, \Inc{A_0}
\}$.\footnote{If the principle of explosion for~$\Inc{A_0}$ was available, then
this identity would entail~$A_{n+1} = A_n$ and thus enable a quick conclusion
of the proof.} This identity can be rewritten to render its directed nature
more apparent:
\[ A_{n+1} \subseteq \bigcup \bigl(\{A_n\} \cup \{X \,|\, \Inc{A_0}\}\bigr). \]
As~$\Incbare$ splits direct joins, we obtain~$\Inc{A_n}$ (and hence~$\Inc{A_0}$ by the
induction hypothesis~$\neg \Inc{A_n}$) or we obtain~$\Inc{A_0}$ directly.

For claim~(b), it is clear that~$(3) \Rightarrow (4) \Rightarrow (1) \Rightarrow
(2)$. For~$(2) \Rightarrow (3)$, let~$x_n \in A$.
If~$\Inc{(A\cup\{x_n\})}$, then~$\Inc{A}$ because~$A\cup\{x_n\}=A$ and hence~$\Inc{A_0}$
by part~(a).
\end{proof}

\begin{theorem}\label{thm:max-inc-countable}Let~$X$ be a countable set equipped
with an inconsistency predicate. Then every subset of~$X$ has a maximal
equiconsistent extension.\end{theorem}

\begin{proof}We verify that for every subset~$A_0 \subseteq X$, the set~$A$ of
Construction~\ref{constr:inc} is an extension of the desired kind. More
precisely, we verify that~$A$ is maximal in that for every subset~$B \subseteq X$,
\[ A \subseteq B \quad\wedge\quad \neg \Inc{B} \quad\Longrightarrow\quad A = B. \]
Let~$x \in B$. Then~$\neg \Inc{(A \cup \{ x \})}$, as~$\Inc{(A \cup \{x\})}$
would imply~$\Inc{B}$ by monotonicity. Hence~$x \in A$ by
Lemma~\ref{lemma:omnibus-inc}(b).
\end{proof}

Theorem~\ref{thm:max-inc-countable} has a number of corollaries, such as:
\begin{enumerate}
\item[(1)] Every countable ring has a maximal ideal (Example~\ref{ex:inc-ring}).
\item[(2)] Every countable ring has a maximal multiplicatively closed
subset not containing zero (Example~\ref{ex:inc-ring2}). Such a subset~$S$ is
multiplicatively saturated and a prime filter in the weak sense that~$x + y \in
S$ and~$x \not\in S$ implies~$y \in S$ (where negation means implication to~$1
= 0$ as in Section~\ref{sect:constr}). The ring of fractions~$A[S^{-1}]$ has
the property that elements which are not nilpotent are invertible. In the case
that~$A$ is reduced, the ring of fractions is a field in the sense that nonzero
elements are invertible. The complement of~$S$ is a (certain weak kind) of a
minimal prime ideal; in classical reverse mathematics, this iterative
construction of a minimal prime ideal is due to
Hatzikiriakou~\cite[Lemma~3.1]{hatzikiriakou:minimal}.
\item[(3)] Every finitely generated module
over a countable ring has a maximal proper submodule
(Example~\ref{ex:inc-module}).
\item[(4)] Every set of sentences over a countable signature can be completed to a
maximal equiconsistent set (Example~\ref{ex:inc-formulas});
this result is a central ingredient in constructive proofs of
Gödel's completeness theorem~\cite{krivine:completeness,herbelin-ilik:henkin,forster-kirst-wehr:completeness}.
\item[(5)] Every countable vector space over a residue field has a maximal linearly
independent set (using the inconsistency predicate and the notion of linear
independence of~\cite[Section~6]{wessel-schuster:radical}). Such a set is
anonymously spanning in that every vector is \emph{not~not} contained in its
span. In this sense countable vector spaces ``almost'' have a basis.
\end{enumerate}


\subsection{The well-founded case}

Fundamental to Construction~\ref{constr:inc} is its step-by-step nature,
requiring that the elements are presented in a single infinite sequence.
If a single such sequence does not
suffice to exhaust all elements, it is conceivable to take a limit step and continue
sequentially from then on.

Let~$I$ be a well-ordering, that is a set equipped with a relation~$({<})$ such
that constructions by transfinite recursion and proofs by induction are
possible. Further assume that~$I$ itself and that for every~$n \in
I$ the set~$\{ k \in I \,|\, k < n \}$ is conditionally directed: For every two
elements of the set, an upper bound is also contained in the set. This
requirement is for instance met in case that~$({<})$ is a linear order.

\begin{construction}\label{constr:inc-wf}Let~$X$ be a set equipped with
an inconsistency predicate~$\Incbare$. Let~$X$ be an image of~$I$, writing~$X = \{ x_n
\,|\, n \in I \}$. Let~``$\neg\varphi$'' mean~``$\varphi \Rightarrow
\Inc{\emptyset}$''. Without appealing to any form of choice, we define by
transfinite recursion
\[ A_n \defeq A_{<n} \cup \bigl\{ x_n \,|\, \neg \Inc{(A_{<n}\cup\{x_n\})} \bigr\}, \]
where~$A_{<n} \defeq \bigcup_{k < n} A_k$, and set~$A \defeq \bigcup_{n \in I} A_n$.
\end{construction}

\begin{lemma}\label{lemma:omnibus-inc-wf}(In the situation of
Construction~\ref{constr:inc-wf}.)
\begin{enumerate}
\item[(a)] The set~$A$ is consistent: $\neg \Inc{A}$.
\item[(b)] For every index~$n \in I$, the following are equivalent: \\
(1) $x_n \in A_n$. \quad
(2) $x_n \in A$. \quad
(3) $\neg \Inc{(A\cup\{x_n\})}$. \quad
(4) $\neg \Inc{(A_{<n} \cup \{x_n\})}$.
\end{enumerate}\end{lemma}

\begin{proof}The proof of Lemma~\ref{lemma:omnibus-inc} carries over almost
verbatim. The only part which requires some adaptation is the verification
that~$\neg \Inc{A_n}$ for every index~$n \in I$. This verification now proceeds by
transfinite induction.

Assuming that~$\neg \Inc{A_k}$ for all~$k < n$, we verify that~$\neg \Inc{A_n}$. So
assume~$\Inc{A_n}$. Since~$A_n \subseteq A_{<n} \cup \{x_n\}$, we have~$\Inc{(A_{<n}
\cup \{x_n\})}$ by monotonicity. Thus~$A_n = A_{<n} \cup
\{x_n\,|\,\Inc{\emptyset}\}$ and hence
\[ A_n \subseteq \bigcup\,\bigl(\{ \emptyset \} \cup \{ A_k \,|\, k < n \} \cup
\{ X \,|\, \Inc{\emptyset} \}\bigr). \]
Because~$\Incbare$ splits directed joins, we obtain~$\Inc{\emptyset}$ (in which case we
are done); or~$\Inc{A_k}$ for some~$k < n$ (in which case we are done by the
induction hypothesis); or~$\Inc{X}$ together with the information
that~$\Inc{\emptyset}$ (so we are done as well).
\end{proof}

\begin{theorem}\label{thm:max-inc-wf}Let~$X$ be a set equipped
with an inconsistency predicate. Assume that~$X$ is an image of~$I$.
Then~$X$ contains a maximal consistent subset.\end{theorem}

\begin{proof}As the proof of Theorem~\ref{thm:max-inc-countable}.\end{proof}

\bibliographystyle{ios1}
\nocite{label}
\bibliography{extended}

\end{document}

\appendix



FUTURE:
* check van der Waerden's book (where he sticks to countable rings)
* compare with situation in reverse mathematics

THANKS
audiences where work has been presented:
Schlehdorf, CiE, Padova, ItaCa Fest, Paris



----------------------- REVIEW 1 ---------------------
SUBMISSION: 40
TITLE: Maximal ideals in countable rings, constructively
AUTHORS: Peter Schuster and Ingo Blechschmidt

----------- Overall evaluation -----------
The authors analyze the classical algebraic result that a nontrivial
commutative unital ring has a maximal ideal (Krull’s theorem) within the
metatheory of constructive set theory with minimal logic. This is part of a
broader program of presenting classical algebraic results in the constructive
setting. This approach avoids the use of Zorn’s lemma (Axiom of Choice) and any
nonconstructive principles or decidability assumptions. The authors’ analysis
of the construction in the framework of minimal logic and in the framework of
Heyting arithmetic, as well as further philosophical discussion and extension
of the results to arbitrary rings are all very interesting.  However, the
constructive approach using functional recursive definition is not new. For
example, it has been used in Lindenbaum’s lemma and in effective Henkin’s
construction establishing Gödel’s completeness theorem. The paper is very well
written and free of typos.
 
Here are some editorial suggestions.

Page 1: Rewrite the sentence in the abstract with the phrase “how for countable
rings one can do without”

Page 3, Proposition 1.1: replace “subset” by “substructure”
WONTFIX

Page 10: incorporate the long footnote into the main text
WONTFIX



----------------------- REVIEW 2 ---------------------
SUBMISSION: 40
TITLE: Maximal ideals in countable rings, constructively
AUTHORS: Peter Schuster and Ingo Blechschmidt

----------- Overall evaluation -----------

I am also not sure of what is the point of giving the inductive generation of
(M) with rules (is this used later)?
WONTFIX


If the proof given for a generic maximal ideal is sufficiently “uniform” you
know a bound for the depth of the (infinite branching) tree. So your “finite
branching dynamic evaluation” is finite: you get an algorithm.
https://events.math.unipd.it/3wftop/pdf/LombardiMunichSlide.pdf
