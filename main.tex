\documentclass[12pt,oneside,reqno]{amsart}

\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{amsthm,mathtools,stmaryrd,amssymb,graphicx}
\usepackage{booktabs}
\usepackage[all]{xy}
\usepackage[protrusion=true,expansion=true]{microtype}
\usepackage{xspace}

\title{Maximal ideals in countable rings, constructively}
\author{}
\email{}

\theoremstyle{definition}
\newtheorem{defn}{Definition}[section]
\newtheorem{ex}[defn]{Example}
\newtheorem{constr}[defn]{Construction}

\theoremstyle{plain}
\newtheorem{prop}[defn]{Proposition}
\newtheorem{cor}[defn]{Corollary}
\newtheorem{lemma}[defn]{Lemma}
\newtheorem{thm}[defn]{Theorem}
\newtheorem{scholium}[defn]{Scholium}

\theoremstyle{remark}
\newtheorem{rem}[defn]{Remark}
\newtheorem{question}[defn]{Question}
\newtheorem{speculation}[defn]{Speculation}
\newtheorem{caveat}[defn]{Caveat}
\newtheorem{conjecture}[defn]{Conjecture}

\newenvironment{indentblock}{%
  \list{}{\leftmargin\leftmargin}%
  \item\relax
}{%
  \endlist
}

\newcommand{\aaa}{\mathfrak{a}}
\newcommand{\bbb}{\mathfrak{b}}
\newcommand{\mmm}{\mathfrak{m}}
\newcommand{\nnn}{\mathfrak{n}}
\newcommand{\ppp}{\mathfrak{p}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\PRA}{\textsc{pra}}
\newcommand{\ZF}{\textsc{zf}}
\newcommand{\IZF}{\textsc{izf}}
\newcommand{\IZFS}{\textsc{izf/s}}
\newcommand{\CZF}{\textsc{czf}}
\newcommand{\ZFC}{\textsc{zfc}}
\newcommand{\ZFCS}{\textsc{zfc/s}}
\newcommand{\ZFCI}{\textsc{zfc+i}}
\newcommand{\RRS}{\textsc{rrs}}
\newcommand{\RDC}{\textsc{rdc}}
\newcommand{\DC}{\textsc{dc}}
\newcommand{\MDC}{\textsc{mdc}}
\newcommand{\ES}{(\IZF+\RRS_2)/\textsc{s}}
\newcommand{\defeq}{\vcentcolon=}
\renewcommand{\_}{\mathpunct{.}\,}

\begin{document}

\begin{abstract}
  While the existence of a maximal ideal in a general nontrivial commutative
  ring is tied together with the axiom of choice, for countable rings one can
  get by with at most dependent choice. By using the relative interpretation of
  negation (i.e., as ``implies~$0=1$'') we can now, in constructive set theory with
  minimal logic, do without any kind of choice. What we obtain by a functional
  recursive definition is an ideal the quotient of which is a residue field
  (every noninvertible element is zero), and under some decidability
  preconditions even a geometric field (every element is either invertible or
  else zero). Krull's lemma for the related notion of prime ideal follows by
  passing to rings of fractions. All this can be carried over to Heyting
  arithmetic with minimal logic, and to rings indexed by any well-founded set.
  Along the way we do a case study for proofs in algebra with minimal logic.
\end{abstract}


\maketitle
\thispagestyle{empty}


Let~$A$ be a commutative ring with unit. In the spirit of Lombardi and QuittÃ©,
by ``not~$\varphi$'' we mean~$\varphi \Rightarrow 1 = 0 \in A$. Consequently,
by~``$x \not\in M$'' we mean~$x \in M \Rightarrow 1 = 0 \in A$, and a subset~$M
\subseteq A$ is \emph{detachable} if and only if for any~$x \in A$, either~$x \in M$
or~$x \not\in M$. This note is set in the context of minimal logic.

We recall that if~$M \subseteq A$ is an arbitrary subset, not necessarily
detachable, then the ideal~$(M)$ generated by~$M$ can be defined
as \[ (M) = \Bigl\{ \sum_{i=1}^n a_i v_i \,\Big|\, n \geq 0, a_1,\ldots,a_n \in
A, v_1,\ldots,v_n \in M \Bigr\}. \]


\section{A construction}
\label{sect:constr}

We assume that the ring~$A$ is countable, with~$x_0, x_1, \ldots$ an
enumeration of the elements of~$A$. We do \emph{not} assume that~$A$ is
discrete or that it is strongly discrete, that is that finitely generated
ideals of~$A$ are detachable. We also do
\emph{not} assume any form of the axiom of choice.

We study the following recursive construction of ideals~$\mmm_0, \mmm_1,
\ldots$ of~$A$:
\begin{align*}
  \mmm_0 &\defeq \{0\} \\
  \mmm_{n+1} &\defeq \mmm_n + (\{ x_n \,|\, 1 \not\in \mmm_n + (x_n) \}).
\end{align*}
Finally, we set~$\mmm \defeq \bigcup_n \mmm_n$. The construction
of~$\mmm_{n+1}$ from~$\mmm_n$ is uniquely specified, requiring no choices of
any form.

The set~$M_n \defeq \{ x_n \,|\, 1 \not\in \mmm_n + (x_n) \}$ occurring in this
construction contains the element~$x_n$ if and only if~$1 \not\in \mmm_n +
(x_n)$; it is obtained from the singleton set~$\{x_n\}$ by bounded separation.
This set~$M_n$ is empty, and thus~$\mmm_{n+1} = \mmm_n$, precisely when~$1 \in \mmm_n + (x_n)$.
However, in the generality we work in, we cannot assume that~$M_n$ is empty or
inhabited.

The ideal~$(M_n)$ is given by
$(M_n) = \{ a x_n \,|\, a = 0 \vee 1 \not\in \mmm_n + (x_n) \}$.

\begin{prop}The subset~$\mmm$ is an ideal.
\end{prop}

\begin{proof}Directed unions of ideals are ideals.\end{proof}

\begin{prop}\label{prop:proper}
The ideal~$\mmm$ is \emph{proper} in the sense that~$1 \not\in \mmm$.\end{prop}

\begin{proof}Assume~$1 \in \mmm$. Then~$1 \in \mmm_n$ for some number~$n \geq 0$. We
verify~$1 = 0$ by induction over~$n$.

If~$n = 0$, then~$1 \in \mmm_0 = \{0\}$. Hence~$1 = 0$.

If~$n > 0$, then~$1 = u + v x_{n-1}$ for some elements~$u,v \in A$ such that~$u
\in \mmm_{n-1}$ and such that~$v = 0$ or~$1 \not\in \mmm_{n-1} + (x_{n-1})$.
In the first case, we have~$1 = u \in \mmm_{n-1}$, hence~$1 = 0$ by the induction
hypothesis. In the second case we have~$1 = 0$ by modus ponens applied to the
implication~$1 \not\in \mmm_{n-1} + (x_{n-1})$ and the fact~$1 \in \mmm_{n-1} +
(x_{n-1})$ (which follows directly from the equation~$1 = u + v x_{n-1}$).
\end{proof}

\begin{lemma}\label{lemma:stage}
For every number~$n \in \NN$, the following are equivalent:
\begin{enumerate}
\item $x_n \in \mmm_{n+1}$.
\item $x_n \in \mmm$.
\item $1 \not\in \mmm + (x_n)$.
\item $1 \not\in \mmm_n + (x_n)$.
\end{enumerate}
\end{lemma}

\begin{proof}It is clear that~$(3) \Rightarrow (4) \Rightarrow (1) \Rightarrow
(2)$. It remains to show that~$(2) \Rightarrow (3)$.

Assume~$x_n \in \mmm$. In order to verify~$1 \not\in \mmm + (x_n)$,
assume~$1 \in \mmm + (x_n)$. Since~$\mmm + (x_n) \subseteq \mmm$,
we have~$1 \in \mmm$. Hence~$1 = 0$ by Proposition~\ref{prop:proper}.\end{proof}

\begin{prop}\label{prop:is-maximal}The ideal~$\mmm$ is \emph{maximal} in the sense that it is proper and that for
any element~$x \in A$, if $1 \not\in \mmm + (x)$, then~$x \in \mmm$.\end{prop}

\begin{proof}Immediate by Lemma~\ref{lemma:stage}.\end{proof}

The first-order maximality condition of Proposition~\ref{prop:is-maximal} is
equivalent to following higher-order version: For any ideal~$\nnn$ such that~$1
\not\in \nnn$, if~$\mmm \subseteq \nnn$, then~$\mmm = \nnn$.

\begin{cor}The ideal~$\mmm$ is \emph{prime} in the sense that it is proper and that for
any elements~$x,y \in A$, if~$xy \in \mmm$ and~$x \not\in \mmm$, then~$y \in
\mmm$.\end{cor}

\begin{proof}By maximality of~$\mmm$, it suffices to verify that~$1 \not\in
\mmm + (y)$. So assume~$1 \in \mmm + (y)$. Then~$x \in (x) \cdot \mmm + (xy)
\subseteq \mmm$ by~$xy \in \mmm$, hence~$x \in \mmm$, thus~$1 = 0$ by the assumption~$x \not\in
\mmm$.\end{proof}

\begin{cor}The ideal~$\mmm$ is \emph{radical} in the sense that if~$x^k \in
\mmm$, then~$x \in \mmm$.\end{cor}

\begin{proof}Let~$x^k \in \mmm$. Then~$1 \not\in \mmm + (x)$, for if~$1 \in
\mmm + (x)$, then also~$1 = 1^k \in (\mmm + (x))^k \subseteq \mmm + (x^k)
\subseteq \mmm$. Hence~$x \in \mmm$ by Lemma~\ref{prop:is-maximal}.\end{proof}

\begin{rem}The ideal~$\mmm$ is double negation stable in the sense that for any
ring element~$x$, if~$\neg\neg(x \in \mmm)$, then~$x \in \mmm$. This is because
by Lemma~\ref{lemma:stage} membership of~$\mmm$ is a negative condition
and~$\neg\neg\neg\varphi \Rightarrow \neg\varphi$ is a tautology of minimal
logic.\end{rem}

The quotient ring~$A/\mmm$ is a so-called \emph{residue field} (its unit is not
zero, and any element which is not invertible is zero -- as with real or
complex numbers).
XXX incorporate suggestion by Peter

\begin{ex}The resulting maximal ideal~$\mmm$ depends on the chosen enumeration
of~$A$. For instance, if we enumerate~$\ZZ$ by~$0,1,-1,2,-2,\ldots$, the
ideal~$\mmm$ will coincide with~$(2)$. If the enumeration starts with some
prime number~$p$, the ideal~$\mmm$ will coincide with~$(p)$.\end{ex}

\begin{ex}If~$A$ is a local ring (in the sense that if a finite sum of ring
elements is invertible then one of the summands is), then~$\mmm = A \setminus
A^\times$.\end{ex}

If we can decide whether a finitely generated ideal contains the
unit or not, we can improve on this result. (For instance this is the case for
strongly discrete rings such as the ring~$\ZZ$, more generally for the ring of integers of any number
field, and for polynomial rings over discrete fields.)

XXX check claim for polynomial rings

\begin{prop}\label{prop:with-test}
Assume that for any finitely generated ideal~$\aaa \subseteq A$, we have~$1
\not\in \aaa$ or~$\neg(1 \not\in \aaa)$. Then:
\begin{enumerate}
\item Each ideal~$\mmm_n$ is finitely generated.
\item The ideal~$\mmm$ is detachable.
\end{enumerate}
Assume furthermore that or any finitely generated ideal~$\aaa \subseteq
A$, we have~$1 \in \aaa$ or~$1 \not\in \aaa$. Then:
\begin{enumerate}
\addtocounter{enumi}{2}
\item The ideal~$\mmm$ is maximal in the strong sense that for any element~$x
\in A$,~$x \in \mmm$ or~$1 \in \mmm + (x)$, which is to say that the quotient ring~$A/\mmm$ is a
\emph{geometric field} (any element is zero or invertible).
\end{enumerate}
\end{prop}

\begin{proof}We verify claim~$(1)$ by induction over~$n$. The case~$n = 0$ is
clear. Let~$n > 0$. By the induction hypothesis, the ideal~$\mmm_{n-1}$ is finitely
generated, hence so is~$\mmm_{n-1} + (x_{n-1})$. By assumption,~$1 \not\in \mmm_{n-1} +
(x_{n-1})$ or~$\neg(1 \not\in \mmm_{n-1} + (x_{n-1}))$. In the first
case~$\mmm_n = \mmm_{n-1} + (x_{n-1})$. In the second case~$\mmm_n =
\mmm_{n-1}$. In both cases
the ideal~$\mmm_n$ is finitely generated.

To verify claim~(2), let an element~$x_n \in A$ be given. By assumption,~$1
\not\in \mmm_n + (x_n)$ or~$\neg(1 \not\in \mmm_n + (x_n))$. Hence~$x_n \in
\mmm$ or~$x_n \not\in \mmm$ by Lemma~\ref{lemma:stage}.

Finally, to verify claim~(3), let an element~$x_n \in A$ be given. By
assumption,~$1 \in \mmm_n + (x_n)$ or~$1 \not\in \mmm_n + (x_n)$. In the first
case~$1 \in \mmm + (x_n)$. In the second
case~$x_n \in \mmm$ by Lemma~\ref{lemma:stage}.
\end{proof}

It is somewhat remarkable that the ideal~$\mmm$ is detachable even though in
general it is not finitely generated. Usually in constructive mathematics, ideals which are not
finitely generated are seldom detachable. For instance the ideal~$\{ x \in
\ZZ \,|\, x = 0 \vee \varphi \} \subseteq \ZZ$ is detachable if and only
if~$\varphi \vee \neg\varphi$.


\section{On the intersection of all prime ideals}

Classically, we have that the intersection of all prime ideals is the
nilradical. In our setup, we have the following substitute:
XXX cite Krull1929

\begin{prop}\label{prop:nilp-prime}Let~$x \in A$ be an element which is not nilpotent. Then there is a
prime ideal~$\ppp \subseteq A$ such that~$x \not\in \ppp$.
\end{prop}

\begin{proof}The localization~$A[x^{-1}]$ is again countable, hence the
construction of Section~\ref{sect:constr} can be carried out to obtain a
maximal (and hence prime) ideal~$\mmm \subseteq A[x^{-1}]$. Any negation
occurring in the terms ``maximal ideal'' and ``prime ideal'' refers to~$1 = 0$
in~$A[x^{-1}]$. Because~$x$ is assumed to be not nilpotent, this is equivalent
to~$1 = 0$ in~$A$. Hence negation with reference to~$A[x^{-1}]$ means the same
as negation with reference to~$A$.

The preimage of~$\mmm$ under the localization homomorphism~$A \to A[x^{-1}]$ is
a prime ideal of~$A$ which doesn't contain~$x$.
\end{proof}

\begin{rem}A closer inspection of the proof of
Proposition~\ref{prop:nilp-prime} reveals that for any element~$x \in A$
(irrespective of whether it is nilpotent), there is an ideal~$\ppp \subseteq A$
such that~$x \in \ppp$ if and only if~$x$ is nilpotent. This ideal is a radical ideal. However, it is
prime only in the following weak sense: If~$1 \in \ppp$, then~$x$ is nilpotent;
and if~$a \in \ppp$ implies that~$x$ is nilpotent, then~$ab \in \ppp \wedge b
\in \ppp$ implies that~$x$ is nilpotent.
\end{rem}

XXX ... often-used case study (cite ...) ...

\begin{prop}Let~$f \in A[X]$ be a polynomial with at least one coefficient
which is not nilpotent. Then~$f$ is not nilpotent in~$A[X]$.
\end{prop}

\begin{proof}By Proposition~\ref{prop:nilp-prime}, there is a prime ideal
$\ppp \subseteq A$ not containing one of the coefficients of~$f$. Hence~$f$ is
not zero over~$A/\ppp$. Since~$\ppp$ is a prime ideal, the quotient
ring~$A/\ppp$ is an integral domain (in the sense that if~$xy = 0$ and~$x \neq
0$, then~$y = 0$), and since~$\ppp$ is double negation stable, the quotient ring~$(A/\ppp)[X]$ is as well. Thus~$f$ is not nilpotent
as an element of~$(A/\ppp)[X]$ and a forteriori not nilpotent as an element
of~$A[X]$.\end{proof}


\section{In Heyting arithmetic}

The construction presented in Section~\ref{sect:constr} crucially rests on the
flexibility of subsets of the given ring~$A$ in contrast to decidable
predicates~$A \to 2$: Without additional hypotheses on~$A$, membership of the
resulting maximal ideal~$\mmm$ is not decidable. As such, the construction is
naturally formalized in a intuitionistic set theories such as~\textsc{czf}
or~\textsc{izf}.

In this section, we explain how with some more care, the construction can also
be carried out in much weaker foundations such as Heyting
arithmetic~\textsc{ha}.

% ring as class
% recursion theorem
% remedy


\section{Generalization to the well-founded case}

In this section, we relax the assumption that the ring~$A$ is countable to the
assumption that~$A$ is the image of a well-founded set~$I$. There are several
definitions of well-foundedness in the literature; we get by with the following
weak requirement: There is a transitive relation~$({<})$ on~$I$ such that
\begin{enumerate}
\item for any class~$M \subseteq I$ which is \emph{progressive} or
\emph{hereditary} in the sense that
\[ \forall n \in I\_
  (\forall m \in I\_ m < n \Rightarrow m \in M) \Longrightarrow n \in M, \]
we have~$M = I$, and
\item both~$I$ and any subset of the form~$\{k \in I \,|\, k < n\}$ which is
inhabited are directed.
% for any elements~$a,b,c \in I$, if~$a < c$ and~$b < c$, then there is an
% element~$w \in I$ such that~$a,b \leq w < c$.
\end{enumerate}
Condition~(2) is for instance satisfied if~$({<})$ is a linear order.

XXX check whether we want class or set?

We write~$A = \{ x_n \,|\, n \in I \}$.
We propose the following recursive construction of ideals~$\mmm_n$, $n \in I$:
\begin{align*}
  \mmm_n &\defeq \mmm_{<n} + (\{ x_n \,|\, 1 \not\in \mmm_{<n} + (x_n) \}),
\end{align*}
where~$\mmm_{<n} \defeq \sum_{k < n} \mmm_k$. We set~$\mmm \defeq \bigcup_{n
\in I} \mmm_n$. As before, no choices of any kind are required.

\begin{prop}\begin{enumerate}
\item The set~$\mmm$ is an ideal.
\item The ideal~$\mmm$ is proper.
\item For an element~$x_n \in A$, the following are equivalent: (a) $x_n \in
\mmm_{n+1}$; (b) $x_n \in \mmm$; (c) $1 \not\in \mmm + (x_n)$; (d) $1 \not \in \mmm_n + (x_n)$.
\item The ideal~$\mmm$ is maximal (and hence prime).
\end{enumerate}
\end{prop}

\begin{proof}The proofs of the countable case carry over word for word.
\end{proof}

We also have an analogue of Proposition~\ref{prop:with-test}, requiring that
for ideals of the form~$\aaa = (f(k))_{k < n}$, where~$f$ is a map~$\{ k \in I
\,|\, k < n \} \to A$, we have~$1 \in \aaa$ or~$1 \not\in \aaa$. However, we
don't know how useful this analogue is.

\end{document}

cite?
https://mileti.math.grinnell.edu/research/ideals.pdf
https://homepages.ecs.vuw.ac.nz/~downey/ideals_talk.ps
https://mathoverflow.net/a/229105/31233
